{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _omit from \"lodash/omit\";\nimport React, { useState, useCallback, useEffect } from \"react\";\nimport { connect } from \"@webiny/app-page-builder/editor/redux\";\nimport { getPlugins } from \"@webiny/plugins\";\nimport { deactivatePlugin, updateRevision } from \"@webiny/app-page-builder/editor/actions\";\nimport { getPage } from \"@webiny/app-page-builder/editor/selectors\";\nimport { useKeyHandler } from \"@webiny/app-page-builder/editor/hooks/useKeyHandler\";\nimport { useSnackbar } from \"@webiny/app-admin/hooks/useSnackbar\";\nimport { OverlayLayout } from \"@webiny/app-admin/components/OverlayLayout\";\nimport { SplitView, LeftPanel, RightPanel } from \"@webiny/app-admin/components/SplitView\";\nimport { Typography } from \"@webiny/ui/Typography\";\nimport { Form } from \"@webiny/form\";\nimport { Icon } from \"@webiny/ui/Icon\";\nimport { ButtonPrimary } from \"@webiny/ui/Button\";\nimport { List, ListItem, ListItemGraphic } from \"@webiny/ui/List\";\nimport { SimpleForm, SimpleFormFooter, SimpleFormContent, SimpleFormHeader } from \"@webiny/app-admin/components/SimpleForm\";\nimport { Title, listItem, ListItemTitle, listStyle, TitleContent } from \"./PageSettingsStyled\";\n\nvar PageSettings = function PageSettings(props) {\n  var plugins = getPlugins(\"pb-editor-page-settings\");\n\n  var _useState = useState(\"pb-editor-page-settings-general\"),\n      _useState2 = _slicedToArray(_useState, 2),\n      active = _useState2[0],\n      setActive = _useState2[1];\n\n  var activePlugin = plugins.find(function (pl) {\n    return pl.name === active;\n  });\n\n  if (!activePlugin) {\n    return null;\n  }\n\n  return /*#__PURE__*/React.createElement(PageSettingsContent, Object.assign({}, props, {\n    setActive: setActive,\n    plugins: plugins,\n    activePlugin: activePlugin\n  }));\n};\n\nvar PageSettingsContent = function PageSettingsContent(_ref) {\n  var page = _ref.page,\n      plugins = _ref.plugins,\n      setActive = _ref.setActive,\n      activePlugin = _ref.activePlugin,\n      deactivatePlugin = _ref.deactivatePlugin,\n      updateRevision = _ref.updateRevision;\n\n  var _useSnackbar = useSnackbar(),\n      showSnackbar = _useSnackbar.showSnackbar;\n\n  var _useKeyHandler = useKeyHandler(),\n      removeKeyHandler = _useKeyHandler.removeKeyHandler,\n      addKeyHandler = _useKeyHandler.addKeyHandler;\n\n  var savePage = useCallback(function (page) {\n    updateRevision(page, {\n      onFinish: function onFinish() {\n        return showSnackbar(\"Settings saved\");\n      }\n    });\n  }, [page]);\n  useEffect(function () {\n    addKeyHandler(\"escape\", function (e) {\n      e.preventDefault();\n      deactivatePlugin({\n        name: \"pb-editor-page-settings-bar\"\n      });\n    });\n    return function () {\n      return removeKeyHandler(\"escape\");\n    };\n  });\n  return /*#__PURE__*/React.createElement(OverlayLayout, {\n    barMiddle: Title,\n    onExited: function onExited() {\n      return deactivatePlugin({\n        name: \"pb-editor-page-settings-bar\"\n      });\n    }\n  }, /*#__PURE__*/React.createElement(SplitView, null, /*#__PURE__*/React.createElement(LeftPanel, {\n    span: 5\n  }, /*#__PURE__*/React.createElement(List, {\n    twoLine: true,\n    className: listStyle\n  }, plugins.map(function (pl) {\n    return /*#__PURE__*/React.createElement(ListItem, {\n      key: pl.name,\n      className: listItem,\n      onClick: function onClick() {\n        return setActive(pl.name);\n      }\n    }, /*#__PURE__*/React.createElement(ListItemGraphic, null, /*#__PURE__*/React.createElement(Icon, {\n      icon: pl.icon\n    })), /*#__PURE__*/React.createElement(TitleContent, null, /*#__PURE__*/React.createElement(ListItemTitle, null, pl.title), /*#__PURE__*/React.createElement(Typography, {\n      use: \"subtitle2\"\n    }, pl.description)));\n  }))), /*#__PURE__*/React.createElement(RightPanel, {\n    span: 7\n  }, /*#__PURE__*/React.createElement(Form, {\n    data: page,\n    onSubmit: savePage\n  }, function (_ref2) {\n    var Bind = _ref2.Bind,\n        submit = _ref2.submit,\n        form = _ref2.form,\n        data = _ref2.data;\n    return /*#__PURE__*/React.createElement(SimpleForm, null, /*#__PURE__*/React.createElement(SimpleFormHeader, {\n      title: activePlugin.title\n    }), /*#__PURE__*/React.createElement(SimpleFormContent, null, activePlugin ? activePlugin.render({\n      Bind: Bind,\n      form: form,\n      data: data\n    }) : null), /*#__PURE__*/React.createElement(SimpleFormFooter, null, /*#__PURE__*/React.createElement(ButtonPrimary, {\n      onClick: submit\n    }, \"Save settings\")));\n  }))));\n};\n\nexport default connect(function (state) {\n  return {\n    page: _omit(getPage(state), [\"content\"])\n  };\n}, {\n  deactivatePlugin: deactivatePlugin,\n  updateRevision: updateRevision\n})(PageSettings);","map":null,"metadata":{},"sourceType":"module"}