{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _createSuper from \"@babel/runtime/helpers/createSuper\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport React from \"react\";\nimport Auth from \"@aws-amplify/auth\";\nimport debug from \"../debug\";\n\nvar RequireNewPassword = /*#__PURE__*/function (_React$Component) {\n  _inherits(RequireNewPassword, _React$Component);\n\n  var _super = _createSuper(RequireNewPassword);\n\n  function RequireNewPassword() {\n    var _this;\n\n    _classCallCheck(this, RequireNewPassword);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n\n    _defineProperty(_assertThisInitialized(_this), \"authStates\", [\"requireNewPassword\"]);\n\n    _defineProperty(_assertThisInitialized(_this), \"checkContact\", function (user) {\n      var changeState = _this.props.changeState;\n      Auth.verifiedContact(user).then(function (data) {\n        if (data.verified) {\n          changeState(\"signedIn\", user);\n        } else {\n          changeState(\"verifyContact\", _objectSpread(_objectSpread({}, user), data));\n        }\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"confirm\", /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref) {\n        var password, requiredAttributes, _this$props, changeState, authData, user;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                password = _ref.password, requiredAttributes = _objectWithoutProperties(_ref, [\"password\"]);\n                _this$props = _this.props, changeState = _this$props.changeState, authData = _this$props.authData;\n                _context.prev = 2;\n                _context.next = 5;\n                return Auth.completeNewPassword(authData, password, requiredAttributes);\n\n              case 5:\n                user = _context.sent;\n                debug(\"complete new password\", user);\n\n                if (user.challengeName === \"SMS_MFA\") {\n                  changeState(\"confirmSignIn\", user);\n                } else if (user.challengeName === \"MFA_SETUP\") {\n                  debug(\"TOTP setup\", user.challengeParam);\n                  changeState(\"TOTPSetup\", user);\n                } else {\n                  _this.checkContact(user);\n                }\n\n                _context.next = 13;\n                break;\n\n              case 10:\n                _context.prev = 10;\n                _context.t0 = _context[\"catch\"](2);\n                debug(_context.t0);\n\n              case 13:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[2, 10]]);\n      }));\n\n      return function (_x) {\n        return _ref2.apply(this, arguments);\n      };\n    }());\n\n    return _this;\n  }\n\n  _createClass(RequireNewPassword, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props2 = this.props,\n          children = _this$props2.children,\n          authProps = _objectWithoutProperties(_this$props2, [\"children\"]);\n\n      var authData = authProps.authData,\n          authState = authProps.authState,\n          changeState = authProps.changeState;\n\n      if (!this.authStates.includes(authState)) {\n        return null;\n      }\n\n      return /*#__PURE__*/React.cloneElement(children, {\n        authProps: authProps,\n        confirm: this.confirm,\n        changeState: changeState,\n        requiredAttributes: authData.challengeParam.requiredAttributes || []\n      });\n    }\n  }]);\n\n  return RequireNewPassword;\n}(React.Component);\n\nexport default RequireNewPassword;","map":null,"metadata":{},"sourceType":"module"}