{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _taggedTemplateLiteral from \"@babel/runtime/helpers/taggedTemplateLiteral\";\n\nfunction _templateObject8() {\n  var data = _taggedTemplateLiteral([\"Save environment alias\"]);\n\n  _templateObject8 = function _templateObject8() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject7() {\n  var data = _taggedTemplateLiteral([\"Choose an existing environment to which this alias will point to.\"]);\n\n  _templateObject7 = function _templateObject7() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject6() {\n  var data = _taggedTemplateLiteral([\"Environment\"]);\n\n  _templateObject6 = function _templateObject6() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject5() {\n  var data = _taggedTemplateLiteral([\"No environment selected.\"]);\n\n  _templateObject5 = function _templateObject5() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject4() {\n  var data = _taggedTemplateLiteral([\"Description\"]);\n\n  _templateObject4 = function _templateObject4() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject3() {\n  var data = _taggedTemplateLiteral([\"Environment with slug \\\"{slug}\\\" already exists.\"]);\n\n  _templateObject3 = function _templateObject3() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject2() {\n  var data = _taggedTemplateLiteral([\"Will be used as part of the GraphQL API URL.\"]);\n\n  _templateObject2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"New environment alias\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React from \"react\";\nimport { Form } from \"@webiny/form\";\nimport { Grid, Cell } from \"@webiny/ui/Grid\";\nimport { Input } from \"@webiny/ui/Input\";\nimport { ButtonPrimary } from \"@webiny/ui/Button\";\nimport { CircularProgress } from \"@webiny/ui/Progress\";\nimport { useCrud } from \"@webiny/app-admin/hooks/useCrud\";\nimport { i18n } from \"@webiny/app/i18n\";\nimport { useApolloClient } from \"react-apollo\";\nimport get from \"lodash.get\";\nimport { GET_ENVIRONMENT_ALIAS_BY_SLUG } from \"./graphql\";\nimport NameSlug from \"../../components/NameSlug\";\nimport { AutoComplete } from \"@webiny/ui/AutoComplete\";\nimport { useCms } from \"@webiny/app-headless-cms/admin/hooks\";\nimport { SimpleFormHeader, SimpleForm, SimpleFormFooter, SimpleFormContent } from \"@webiny/app-admin/components/SimpleForm\";\nvar t = i18n.ns(\"app-headless-cms/admin/environmentAliases/form\");\n\nfunction EnvironmentAliasesForm() {\n  var _useCrud = useCrud(),\n      crudForm = _useCrud.form;\n\n  var _useCms = useCms(),\n      environmentsOptions = _useCms.environments.environments;\n\n  var apolloClient = useApolloClient();\n  return /*#__PURE__*/React.createElement(Form, crudForm, function (_ref) {\n    var data = _ref.data,\n        form = _ref.form,\n        Bind = _ref.Bind,\n        setValue = _ref.setValue;\n    return /*#__PURE__*/React.createElement(SimpleForm, {\n      \"data-testid\": \"pb-environmentAliases-form\"\n    }, crudForm.loading && /*#__PURE__*/React.createElement(CircularProgress, null), /*#__PURE__*/React.createElement(SimpleFormHeader, {\n      title: data.name ? data.name : t(_templateObject())\n    }), /*#__PURE__*/React.createElement(SimpleFormContent, null, /*#__PURE__*/React.createElement(Grid, null, /*#__PURE__*/React.createElement(NameSlug, {\n      newEntry: !crudForm.id,\n      Bind: Bind,\n      setValue: setValue,\n      slug: {\n        description: t(_templateObject2())\n      },\n      validateSlugUniqueness: /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var getEnvironmentAliasBySlug, existingEnvironmentAlias;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (!data.id) {\n                  _context.next = 2;\n                  break;\n                }\n\n                return _context.abrupt(\"return\");\n\n              case 2:\n                _context.next = 4;\n                return apolloClient.query({\n                  query: GET_ENVIRONMENT_ALIAS_BY_SLUG,\n                  variables: {\n                    slug: data.slug\n                  }\n                });\n\n              case 4:\n                getEnvironmentAliasBySlug = _context.sent;\n                existingEnvironmentAlias = get(getEnvironmentAliasBySlug, \"data.cms.getEnvironmentAlias.data\");\n\n                if (!existingEnvironmentAlias) {\n                  _context.next = 8;\n                  break;\n                }\n\n                throw new Error(t(_templateObject3())({\n                  slug: data.slug\n                }));\n\n              case 8:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }))\n    }), /*#__PURE__*/React.createElement(Cell, {\n      span: 12\n    }, /*#__PURE__*/React.createElement(Bind, {\n      name: \"description\"\n    }, function (props) {\n      return /*#__PURE__*/React.createElement(Input, Object.assign({}, props, {\n        rows: 4,\n        maxLength: 200,\n        characterCount: true,\n        label: t(_templateObject4())\n      }));\n    })), /*#__PURE__*/React.createElement(Cell, {\n      span: 12\n    }, /*#__PURE__*/React.createElement(Bind, {\n      name: \"environment\"\n    }, function (props) {\n      return /*#__PURE__*/React.createElement(AutoComplete, Object.assign({}, props, {\n        placeholder: t(_templateObject5()),\n        label: t(_templateObject6()),\n        options: environmentsOptions,\n        description: t(_templateObject7())\n      }));\n    })))), /*#__PURE__*/React.createElement(SimpleFormFooter, null, /*#__PURE__*/React.createElement(ButtonPrimary, {\n      onClick: form.submit\n    }, t(_templateObject8()))));\n  });\n}\n\nexport default EnvironmentAliasesForm;","map":null,"metadata":{},"sourceType":"module"}