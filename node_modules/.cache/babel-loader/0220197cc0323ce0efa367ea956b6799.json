{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _taggedTemplateLiteral from \"@babel/runtime/helpers/taggedTemplateLiteral\";\n\nfunction _templateObject5() {\n  var data = _taggedTemplateLiteral([\"Publish\"]);\n\n  _templateObject5 = function _templateObject5() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject4() {\n  var data = _taggedTemplateLiteral([\"Publish changes\"]);\n\n  _templateObject4 = function _templateObject4() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject3() {\n  var data = _taggedTemplateLiteral([\"Your form was published successfully!\"]);\n\n  _templateObject3 = function _templateObject3() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject2() {\n  var data = _taggedTemplateLiteral([\"You are about to publish this form, are you sure want to continue?\"]);\n\n  _templateObject2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"Publish form\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React from \"react\";\nimport { Mutation } from \"react-apollo\";\nimport { useRouter } from \"@webiny/react-router\";\nimport { ButtonPrimary } from \"@webiny/ui/Button\";\nimport { ConfirmationDialog } from \"@webiny/ui/ConfirmationDialog\";\nimport { useSnackbar } from \"@webiny/app-admin/hooks/useSnackbar\";\nimport { useFormEditor } from \"@webiny/app-form-builder/admin/components/FormEditor/Context\";\nimport { publishRevision } from \"./PublishFormButton/graphql\";\nimport { i18n } from \"@webiny/app/i18n\";\nvar t = i18n.namespace(\"FormEditor.PublishPageButton\");\n\nvar PublishFormButton = function PublishFormButton() {\n  var _useFormEditor = useFormEditor(),\n      data = _useFormEditor.state.data;\n\n  var _useSnackbar = useSnackbar(),\n      showSnackbar = _useSnackbar.showSnackbar;\n\n  var _useRouter = useRouter(),\n      history = _useRouter.history;\n\n  return /*#__PURE__*/React.createElement(ConfirmationDialog, {\n    title: t(_templateObject()),\n    message: t(_templateObject2())\n  }, function (_ref) {\n    var showConfirmation = _ref.showConfirmation;\n    return /*#__PURE__*/React.createElement(Mutation, {\n      mutation: publishRevision,\n      refetchQueries: [\"FormsListForms\"]\n    }, function (update) {\n      return /*#__PURE__*/React.createElement(ButtonPrimary, {\n        onClick: /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n          return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n            while (1) {\n              switch (_context2.prev = _context2.next) {\n                case 0:\n                  showConfirmation( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n                    var response, error;\n                    return _regeneratorRuntime.wrap(function _callee$(_context) {\n                      while (1) {\n                        switch (_context.prev = _context.next) {\n                          case 0:\n                            _context.next = 2;\n                            return update({\n                              variables: {\n                                id: data.id\n                              }\n                            });\n\n                          case 2:\n                            response = _context.sent;\n                            error = response.data.forms.publishRevision.error;\n\n                            if (!error) {\n                              _context.next = 6;\n                              break;\n                            }\n\n                            return _context.abrupt(\"return\", showSnackbar(error.message));\n\n                          case 6:\n                            history.push(\"/forms?id=\".concat(data.id)); // Let's wait a bit, because we are also redirecting the user.\n\n                            setTimeout(function () {\n                              showSnackbar(t(_templateObject3()));\n                            }, 500);\n\n                          case 8:\n                          case \"end\":\n                            return _context.stop();\n                        }\n                      }\n                    }, _callee);\n                  })));\n\n                case 1:\n                case \"end\":\n                  return _context2.stop();\n              }\n            }\n          }, _callee2);\n        }))\n      }, data.version > 1 ? t(_templateObject4()) : t(_templateObject5()));\n    });\n  });\n};\n\nexport default PublishFormButton;","map":null,"metadata":{},"sourceType":"module"}