{"ast":null,"code":"import _taggedTemplateLiteral from \"@babel/runtime/helpers/taggedTemplateLiteral\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nfunction _templateObject3() {\n  var data = _taggedTemplateLiteral([\"Change environment\"]);\n\n  _templateObject3 = function _templateObject3() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject2() {\n  var data = _taggedTemplateLiteral([\"N/A\"]);\n\n  _templateObject2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"Headless CMS\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { useState, useEffect } from \"react\";\nimport { i18n } from \"@webiny/app/i18n\";\nvar t = i18n.ns(\"app-headless-cms/admin/menus\");\nimport { ReactComponent as HeadlessCmsIcon } from \"@svgr/webpack!../../icons/devices_other-black-24px.svg\";\nimport { ReactComponent as EnvironmentIcon } from \"@svgr/webpack!../../icons/call_split-24px.svg\";\nimport { Typography } from \"@webiny/ui/Typography\";\nimport { css } from \"emotion\";\nimport { useNavigation } from \"@webiny/app-admin/plugins/Menu/Navigation/components\";\nimport EnvironmentSelectorDialog from \"./../../components/EnvironmentSelectorDialog\";\nimport { useCms } from \"@webiny/app-headless-cms/admin/hooks\";\nimport { useQuery } from \"@webiny/app-headless-cms/admin/hooks\";\nimport { registerPlugins, unregisterPlugin, getPlugin, getPlugins } from \"@webiny/plugins\";\nimport { LIST_MENU_CONTENT_GROUPS_MODELS } from \"./../../viewsGraphql\";\nimport get from \"lodash/get\";\nvar style = {\n  itemsList: /*#__PURE__*/css({\n    paddingTop: 10,\n    paddingBottom: 10,\n    \"> li\": {\n      display: \"flex\",\n      alignItems: \"center\",\n      paddingTop: 2,\n      paddingBottom: 2\n    }\n  }, \"label:itemsList;\"),\n  icon: /*#__PURE__*/css({\n    width: 16,\n    height: 16\n  }, \"label:icon;\"),\n  environmentLi: /*#__PURE__*/css({\n    color: \"var(--mdc-theme-text-secondary-on-background)\"\n  }, \"label:environmentLi;\"),\n  environmentLiIcon: /*#__PURE__*/css({\n    width: 16,\n    height: 16\n  }, \"label:environmentLiIcon;\"),\n  environmentLiLabel: /*#__PURE__*/css({\n    marginLeft: 2,\n    width: 110,\n    whiteSpace: \"nowrap\",\n    overflow: \"hidden\",\n    textOverflow: \"ellipsis\"\n  }, \"label:environmentLiLabel;\"),\n  changeEnvironmentLiLink: /*#__PURE__*/css({\n    color: \"var(--mdc-theme-primary)\"\n  }, \"label:changeEnvironmentLiLink;\")\n};\n\nvar HeadlessCmsMenu = function HeadlessCmsMenu(_ref) {\n  var Menu = _ref.Menu,\n      children = _ref.children;\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      dialogOpened = _useState2[0],\n      setDialogOpened = _useState2[1];\n\n  var _useNavigation = useNavigation(),\n      hideMenu = _useNavigation.hideMenu;\n\n  var _useCms = useCms(),\n      currentEnvironment = _useCms.environments.currentEnvironment;\n\n  var response = useQuery(LIST_MENU_CONTENT_GROUPS_MODELS);\n  var contentModelGroups = get(response, \"data.listContentModelGroups.data\", []);\n  var cmgHash = contentModelGroups.reduce(function (returnValue, currentValue) {\n    return returnValue + currentValue.contentModels.reduce(function (returnValue, currentValue) {\n      return returnValue + currentValue.modelId;\n    }, \"\");\n  }, \"\"); // Generate \"admin-global-search\" plugins - enables the user to search content via the global search bar.\n\n  useEffect(function () {\n    // 1. Unregister all previously registered plugins.\n    getPlugins(\"admin-global-search\").filter(function (item) {\n      return item.name.startsWith(\"admin-global-search-headless-cms\");\n    }).forEach(function (item) {\n      return unregisterPlugin(item.name);\n    }); // 2. Register a new set of plugins via the latest list of content models.\n\n    contentModelGroups.forEach(function (group) {\n      group.contentModels.forEach(function (contentModel) {\n        var pluginName = \"admin-global-search-headless-cms-\" + contentModel.modelId;\n\n        if (!getPlugin(pluginName)) {\n          registerPlugins({\n            type: \"admin-global-search\",\n            name: \"admin-global-search-headless-cms-\" + contentModel.modelId,\n            route: \"/cms/content-models/manage/\" + contentModel.modelId,\n            label: contentModel.name\n          });\n        }\n      });\n    });\n  }, [get(currentEnvironment, \"id\"), cmgHash]);\n  return /*#__PURE__*/React.createElement(Menu, {\n    onClick: function onClick(toggleMenu) {\n      return !dialogOpened && toggleMenu();\n    },\n    name: \"headless-cms\",\n    icon: /*#__PURE__*/React.createElement(HeadlessCmsIcon, null),\n    label: /*#__PURE__*/React.createElement(\"ul\", {\n      className: style.itemsList\n    }, /*#__PURE__*/React.createElement(\"li\", null, t(_templateObject())), /*#__PURE__*/React.createElement(\"li\", {\n      className: style.environmentLi\n    }, /*#__PURE__*/React.createElement(EnvironmentIcon, {\n      className: style.environmentLiIcon\n    }), /*#__PURE__*/React.createElement(Typography, {\n      use: \"caption\",\n      className: style.environmentLiLabel\n    }, currentEnvironment ? currentEnvironment.name : t(_templateObject2()))), /*#__PURE__*/React.createElement(\"li\", null, /*#__PURE__*/React.createElement(Typography, {\n      use: \"caption\"\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: style.changeEnvironmentLiLink,\n      onClick: function onClick(e) {\n        e.preventDefault();\n        e.stopPropagation();\n        setDialogOpened(true);\n      }\n    }, t(_templateObject3()))), /*#__PURE__*/React.createElement(EnvironmentSelectorDialog, {\n      open: dialogOpened,\n      onClose: function onClose() {\n        setDialogOpened(false);\n        hideMenu();\n      }\n    })))\n  }, children);\n};\n\nexport default HeadlessCmsMenu;","map":null,"metadata":{},"sourceType":"module"}