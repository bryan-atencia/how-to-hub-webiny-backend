{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _taggedTemplateLiteral from \"@babel/runtime/helpers/taggedTemplateLiteral\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nfunction _templateObject4() {\n  var data = _taggedTemplateLiteral([\"{title} was deleted successfully!\"]);\n\n  _templateObject4 = function _templateObject4() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject3() {\n  var data = _taggedTemplateLiteral([\"Could not delete content\"]);\n\n  _templateObject3 = function _templateObject3() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject2() {\n  var data = _taggedTemplateLiteral([\"You are about to delete this content entry and all of its revisions!\\n                    Are you sure you want to permanently delete {title}?\"]);\n\n  _templateObject2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"Delete content entry\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { useCallback, useMemo } from \"react\";\nimport { css } from \"emotion\";\nimport get from \"lodash/get\";\nimport { IconButton } from \"@webiny/ui/Button\";\nimport I18NValue from \"@webiny/app-i18n/components/I18NValue\";\nimport { Menu, MenuItem } from \"@webiny/ui/Menu\";\nimport { ListItemGraphic } from \"@webiny/ui/List\";\nimport { Icon } from \"@webiny/ui/Icon\";\nimport { useRouter } from \"@webiny/react-router\";\nimport { useSnackbar } from \"@webiny/app-admin/hooks/useSnackbar\";\nimport { useDialog } from \"@webiny/app-admin/hooks/useDialog\";\nimport { createDeleteMutation } from \"@webiny/app-headless-cms/admin/components/ContentModelForm/graphql\";\nimport { useMutation } from \"@webiny/app-headless-cms/admin/hooks\";\nimport { useConfirmationDialog } from \"@webiny/app-admin/hooks/useConfirmationDialog\";\nimport { i18n } from \"@webiny/app/i18n\";\nvar t = i18n.ns(\"app-headless-cms/admin/plugins/content-details/header/content-form-options-menu\");\nimport { ReactComponent as MoreVerticalIcon } from \"@svgr/webpack!@webiny/app-headless-cms/admin/icons/more_vert.svg\";\nimport { ReactComponent as DeleteIcon } from \"@svgr/webpack!@webiny/app-headless-cms/admin/icons/delete.svg\";\nvar menuStyles = /*#__PURE__*/css({\n  width: 250,\n  right: -105,\n  left: \"auto !important\",\n  \".disabled\": {\n    opacity: 0.5,\n    pointerEvents: \"none\"\n  }\n}, \"label:menuStyles;\");\n\nvar ContentFormOptionsMenu = function ContentFormOptionsMenu(_ref) {\n  var contentModel = _ref.contentModel,\n      content = _ref.content,\n      dataList = _ref.dataList,\n      getLoading = _ref.getLoading,\n      setLoading = _ref.setLoading;\n\n  var _useSnackbar = useSnackbar(),\n      showSnackbar = _useSnackbar.showSnackbar;\n\n  var _useRouter = useRouter(),\n      history = _useRouter.history;\n\n  var _useDialog = useDialog(),\n      showDialog = _useDialog.showDialog;\n\n  var DELETE_CONTENT = useMemo(function () {\n    return createDeleteMutation(contentModel);\n  }, [contentModel.modelId]);\n\n  var _useMutation = useMutation(DELETE_CONTENT),\n      _useMutation2 = _slicedToArray(_useMutation, 1),\n      deleteContentMutation = _useMutation2[0];\n\n  var title = I18NValue({\n    value: get(content, \"meta.title\")\n  });\n\n  var _useConfirmationDialo = useConfirmationDialog({\n    title: t(_templateObject()),\n    message: /*#__PURE__*/React.createElement(\"p\", null, t(_templateObject2())({\n      title: /*#__PURE__*/React.createElement(\"strong\", null, title)\n    }))\n  }),\n      showConfirmation = _useConfirmationDialo.showConfirmation;\n\n  var confirmDelete = useCallback(function () {\n    showConfirmation( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var _yield$deleteContentM, res, _get, error, query;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              setLoading(true);\n              _context.next = 3;\n              return deleteContentMutation({\n                variables: {\n                  revision: content.meta.parent\n                }\n              });\n\n            case 3:\n              _yield$deleteContentM = _context.sent;\n              res = _yield$deleteContentM.data;\n              setLoading(false);\n              dataList.refresh();\n              _get = get(res, \"content\"), error = _get.error;\n\n              if (!error) {\n                _context.next = 10;\n                break;\n              }\n\n              return _context.abrupt(\"return\", showDialog(error.message, {\n                title: t(_templateObject3())\n              }));\n\n            case 10:\n              showSnackbar(t(_templateObject4())({\n                title: /*#__PURE__*/React.createElement(\"strong\", null, title)\n              }));\n              query = new URLSearchParams(location.search);\n              query.delete(\"id\");\n              history.push({\n                search: query.toString()\n              });\n\n            case 14:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    })));\n  }, null);\n  return /*#__PURE__*/React.createElement(Menu, {\n    className: menuStyles,\n    handle: /*#__PURE__*/React.createElement(IconButton, {\n      icon: /*#__PURE__*/React.createElement(MoreVerticalIcon, null)\n    })\n  }, /*#__PURE__*/React.createElement(MenuItem, {\n    onClick: confirmDelete,\n    disabled: !content.id || getLoading()\n  }, /*#__PURE__*/React.createElement(ListItemGraphic, null, /*#__PURE__*/React.createElement(Icon, {\n    icon: /*#__PURE__*/React.createElement(DeleteIcon, null)\n  })), \"Delete\"));\n};\n\nexport default ContentFormOptionsMenu;","map":null,"metadata":{},"sourceType":"module"}