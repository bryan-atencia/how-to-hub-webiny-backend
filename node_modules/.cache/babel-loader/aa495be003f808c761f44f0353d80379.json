{"ast":null,"code":"import _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport * as React from \"react\";\nimport { Transition } from \"react-transition-group\";\nimport isEqual from \"lodash/isEqual\";\nimport { connect } from \"@webiny/app-page-builder/editor/redux\";\nimport { useHandler } from \"@webiny/app/hooks/useHandler\";\nimport { getPlugins } from \"@webiny/plugins\";\nimport { renderPlugins } from \"@webiny/app/plugins\";\nimport { dragStart, dragEnd, activateElement, highlightElement } from \"@webiny/app-page-builder/editor/actions\";\nimport { getElementProps, getElement } from \"@webiny/app-page-builder/editor/selectors\";\nimport Draggable from \"./Draggable\";\nimport { defaultStyle, ElementContainer, transitionStyles, typeStyle } from \"./Element/ElementStyled\";\nimport tryRenderingPlugin from \"./../../utils/tryRenderingPlugin\";\n\nvar getElementPlugin = function getElementPlugin(element) {\n  if (!element) {\n    return null;\n  }\n\n  var plugins = getPlugins(\"pb-editor-page-element\");\n  return plugins.find(function (pl) {\n    return pl.elementType === element.type;\n  });\n};\n\nvar Element = function Element(props) {\n  var dragEnd = props.dragEnd,\n      element = props.element,\n      highlight = props.highlight,\n      active = props.active,\n      _props$className = props.className,\n      className = _props$className === void 0 ? \"\" : _props$className;\n  var plugin = getElementPlugin(element);\n  var beginDrag = useHandler(props, function (_ref) {\n    var dragStart = _ref.dragStart,\n        element = _ref.element;\n    return function () {\n      var data = {\n        id: element.id,\n        type: element.type,\n        path: element.path\n      };\n      setTimeout(function () {\n        dragStart({\n          element: data\n        });\n      });\n      return _objectSpread(_objectSpread({}, data), {}, {\n        target: plugin.target\n      });\n    };\n  });\n  var endDrag = React.useCallback(function (props, monitor) {\n    dragEnd({\n      element: monitor.getItem()\n    });\n  }, [dragEnd]);\n  var onClick = useHandler(props, function (_ref2) {\n    var element = _ref2.element,\n        active = _ref2.active,\n        activateElement = _ref2.activateElement;\n    return function () {\n      if (element.type === \"document\") {\n        return;\n      }\n\n      if (!active) {\n        activateElement({\n          element: element.id\n        });\n      }\n    };\n  });\n  var onMouseOver = useHandler(props, function (_ref3) {\n    var element = _ref3.element,\n        highlight = _ref3.highlight,\n        highlightElement = _ref3.highlightElement;\n    return function (e) {\n      if (element.type === \"document\") {\n        return;\n      }\n\n      e.stopPropagation();\n\n      if (!highlight) {\n        highlightElement({\n          element: element.id\n        });\n      }\n    };\n  });\n  var renderDraggable = useHandler(props, function (_ref4) {\n    var element = _ref4.element;\n    return function (_ref5) {\n      var drag = _ref5.drag;\n      return /*#__PURE__*/React.createElement(\"div\", {\n        ref: drag,\n        className: \"type \" + typeStyle\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"background\",\n        onClick: onClick\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"element-holder\",\n        onClick: onClick\n      }, renderPlugins(\"pb-editor-page-element-action\", {\n        element: element,\n        plugin: plugin\n      }), /*#__PURE__*/React.createElement(\"span\", null, plugin.elementType)));\n    };\n  });\n\n  if (!plugin) {\n    return null;\n  }\n\n  var renderedPlugin = tryRenderingPlugin(function () {\n    return plugin.render({\n      element: element\n    });\n  });\n  return /*#__PURE__*/React.createElement(Transition, {\n    in: true,\n    timeout: 250,\n    appear: true\n  }, function (state) {\n    return /*#__PURE__*/React.createElement(ElementContainer, {\n      id: element.id,\n      onMouseOver: onMouseOver,\n      highlight: highlight,\n      active: active,\n      style: _objectSpread(_objectSpread({}, defaultStyle), transitionStyles[state]),\n      className: \"webiny-pb-page-element-container\"\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: [\"innerWrapper\", className].filter(function (c) {\n        return c;\n      }).join(\" \")\n    }, /*#__PURE__*/React.createElement(Draggable, {\n      target: plugin.target,\n      beginDrag: beginDrag,\n      endDrag: endDrag\n    }, renderDraggable), renderedPlugin));\n  });\n};\n\nexport default connect(function (state, props) {\n  return _objectSpread(_objectSpread({}, getElementProps(state, props)), {}, {\n    element: getElement(state, props.id)\n  });\n}, {\n  dragStart: dragStart,\n  dragEnd: dragEnd,\n  activateElement: activateElement,\n  highlightElement: highlightElement\n}, null, {\n  areStatePropsEqual: isEqual\n})( /*#__PURE__*/React.memo(Element));","map":null,"metadata":{},"sourceType":"module"}