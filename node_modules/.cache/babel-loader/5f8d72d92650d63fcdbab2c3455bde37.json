{"ast":null,"code":"import React from \"react\";\nimport { ReactComponent as FlipIcon } from \"@svgr/webpack!./icons/flip.svg\";\nimport Cropper from \"cropperjs\";\nimport \"cropperjs/dist/cropper.css\";\nimport { IconButton, ButtonDefault } from \"@webiny/ui/Button\";\nimport { Tooltip } from \"@webiny/ui/Tooltip\";\nvar cropper = null;\nvar flipped = {\n  x: 1,\n  y: 1\n};\n\nvar renderForm = function renderForm() {\n  return /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      textAlign: \"center\"\n    }\n  }, /*#__PURE__*/React.createElement(ButtonDefault, {\n    onClick: function onClick() {\n      if (!cropper) {\n        return;\n      }\n\n      flipped.x = flipped.x === 1 ? -1 : 1;\n      cropper.scaleX(flipped.x);\n    }\n  }, \"FlipX\"), /*#__PURE__*/React.createElement(ButtonDefault, {\n    onClick: function onClick() {\n      if (!cropper) {\n        return;\n      }\n\n      flipped.y = flipped.y === 1 ? -1 : 1;\n      cropper.scaleY(flipped.y);\n    }\n  }, \"FlipY\"));\n};\n\nvar tool = {\n  name: \"flip\",\n  icon: function icon(_ref) {\n    var activateTool = _ref.activateTool;\n    return /*#__PURE__*/React.createElement(Tooltip, {\n      placement: \"bottom\",\n      content: \"Flip\"\n    }, /*#__PURE__*/React.createElement(IconButton, {\n      icon: /*#__PURE__*/React.createElement(FlipIcon, null),\n      onClick: activateTool\n    }));\n  },\n  renderForm: renderForm,\n  cancel: function cancel() {\n    return cropper && cropper.destroy();\n  },\n  onActivate: function onActivate(_ref2) {\n    var canvas = _ref2.canvas;\n    cropper = new Cropper(canvas.current, {\n      background: false,\n      modal: false,\n      guides: false,\n      dragMode: \"none\",\n      highlight: false,\n      autoCrop: false\n    });\n  },\n  apply: function apply(_ref3) {\n    var canvas = _ref3.canvas;\n    return new Promise(function (resolve) {\n      if (!cropper) {\n        resolve();\n        return;\n      }\n\n      var current = canvas.current;\n      var src = cropper.getCroppedCanvas().toDataURL();\n\n      if (current) {\n        var image = new window.Image();\n        var ctx = current.getContext(\"2d\");\n\n        image.onload = function () {\n          ctx.drawImage(image, 0, 0);\n          current.width = image.width;\n          current.height = image.height;\n          ctx.drawImage(image, 0, 0);\n          resolve();\n        };\n\n        image.src = src;\n      }\n\n      cropper.destroy();\n    });\n  }\n};\nexport default tool;","map":null,"metadata":{},"sourceType":"module"}