{"version":3,"sources":["../../../../src/admin/views/PersonalAccessTokens/TokenListItem.tsx"],"names":["React","useState","useSnackbar","useApolloClient","DELETE_PAT","UPDATE_PAT","Dialog","DialogAccept","DialogActions","DialogCancel","DialogContent","DialogTitle","Input","ListItemMeta","SimpleListItem","IconButton","ConfirmationDialog","i18n","t","ns","TokenListItem","setFormIsLoading","data","setValue","PAT","showEditDialog","setShowEditDialog","name","tokenName","setTokenName","showSnackbar","client","deleteToken","mutate","mutation","variables","id","queryResponse","error","security","deletePAT","message","action","newPATs","personalAccessTokens","filter","crtPAT","updateToken","updatePAT","map","newName","slice","paddingLeft","showConfirmation"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\nimport { useSnackbar } from \"@webiny/app-admin/hooks/useSnackbar\";\nimport { useApolloClient } from \"react-apollo\";\nimport { DELETE_PAT, UPDATE_PAT } from \"@webiny/app-security/admin/views/AccountGraphql\";\nimport {\n    Dialog,\n    DialogAccept,\n    DialogActions,\n    DialogCancel,\n    DialogContent,\n    DialogTitle\n} from \"@webiny/ui/Dialog\";\nimport { Input } from \"@webiny/ui/Input\";\nimport { ListItemMeta, SimpleListItem } from \"@webiny/ui/List\";\nimport { IconButton } from \"@webiny/ui/Button\";\nimport { ReactComponent as EditIcon } from \"@webiny/app-security/admin/assets/icons/edit-24px.svg\";\nimport { ConfirmationDialog } from \"@webiny/ui/ConfirmationDialog\";\nimport { ReactComponent as DeleteIcon } from \"@webiny/app-security/admin/assets/icons/delete-24px.svg\";\nimport { i18n } from \"@webiny/app/i18n\";\nconst t = i18n.ns(\"app-security/admin/roles/data-list\");\n\nconst TokenListItem = ({ setFormIsLoading, data, setValue, PAT }) => {\n    const [showEditDialog, setShowEditDialog] = useState(false);\n    const [tokenName, setTokenName] = useState(PAT.name);\n    const { showSnackbar } = useSnackbar();\n    const client = useApolloClient();\n\n    const deleteToken = async () => {\n        setFormIsLoading(true);\n        const queryResponse = await client.mutate({\n            mutation: DELETE_PAT,\n            variables: {\n                id: PAT.id\n            }\n        });\n        setFormIsLoading(false);\n\n        const { error } = queryResponse.data.security.deletePAT;\n        if (error) {\n            return showSnackbar(error.message, {\n                action: t`Close`\n            });\n        }\n\n        const newPATs = data.personalAccessTokens.filter(crtPAT => crtPAT.id != PAT.id);\n\n        setValue(\"personalAccessTokens\", newPATs);\n        showSnackbar(t`Token deleted successfully!`);\n    };\n\n    const updateToken = async () => {\n        setFormIsLoading(true);\n        const queryResponse = await client.mutate({\n            mutation: UPDATE_PAT,\n            variables: {\n                id: PAT.id,\n                data: {\n                    name: tokenName\n                }\n            }\n        });\n        setFormIsLoading(false);\n\n        const { error } = queryResponse.data.security.updatePAT;\n        if (error) {\n            return showSnackbar(error.message, {\n                action: t`Close`\n            });\n        }\n\n        const newPATs = data.personalAccessTokens.map(crtPAT =>\n            crtPAT !== PAT\n                ? crtPAT\n                : {\n                      ...crtPAT,\n                      name: tokenName\n                  }\n        );\n\n        setValue(\"personalAccessTokens\", newPATs);\n        showSnackbar(t`Token updated successfully!`);\n    };\n\n    return (\n        <>\n            <Dialog\n                open={showEditDialog}\n                onClose={() => setShowEditDialog(false)}\n                data-testid=\"update-personal-account-token-dialog\"\n            >\n                <DialogTitle>{t`Update Token`}</DialogTitle>\n                <DialogContent>\n                    <Input\n                        label={t`Token name`}\n                        value={tokenName}\n                        onChange={newName => setTokenName(newName.slice(0, 100))}\n                    />\n                </DialogContent>\n                <DialogActions>\n                    <DialogCancel>Cancel</DialogCancel>\n                    <DialogAccept\n                        data-testid={`AcceptUpdateToken-${PAT.id}`}\n                        onClick={() => updateToken()}\n                    >\n                        {t`OK`}\n                    </DialogAccept>\n                </DialogActions>\n            </Dialog>\n\n            <SimpleListItem\n                data-testid=\"pat-tokens-list-item\"\n                key={PAT.id}\n                text={<div style={{ paddingLeft: \"16px\" }}>{PAT.name}</div>}\n            >\n                <ListItemMeta>\n                    <IconButton\n                        data-testid=\"update-personal-access-token\"\n                        onClick={() => setShowEditDialog(true)}\n                        icon={<EditIcon />}\n                    />\n                    <ConfirmationDialog\n                        data-testid=\"delete-personal-access-token-dialog\"\n                        title={t`Delete Token`}\n                        message={t`Are you sure you want to delete this token?`}\n                    >\n                        {({ showConfirmation }) => {\n                            return (\n                                <IconButton\n                                    data-testid={`delete-personal-access-token`}\n                                    onClick={() => showConfirmation(() => deleteToken())}\n                                    icon={<DeleteIcon />}\n                                />\n                            );\n                        }}\n                    </ConfirmationDialog>\n                </ListItemMeta>\n            </SimpleListItem>\n        </>\n    );\n};\n\nexport default TokenListItem;\n"],"file":"TokenListItem.js"}