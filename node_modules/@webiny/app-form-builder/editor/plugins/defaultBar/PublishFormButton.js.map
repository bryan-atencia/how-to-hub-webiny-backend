{"version":3,"sources":["../../../../src/editor/plugins/defaultBar/PublishFormButton.tsx"],"names":["React","Mutation","useRouter","ButtonPrimary","ConfirmationDialog","useSnackbar","useFormEditor","publishRevision","i18n","t","namespace","PublishFormButton","data","state","showSnackbar","history","showConfirmation","update","variables","id","response","error","forms","message","push","setTimeout","version"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,QAAT,QAAyB,cAAzB;AACA,SAASC,SAAT,QAA0B,sBAA1B;AACA,SAASC,aAAT,QAA8B,mBAA9B;AACA,SAASC,kBAAT,QAAmC,+BAAnC;AACA,SAASC,WAAT,QAA4B,qCAA5B;AACA,SAASC,aAAT,QAA8B,8DAA9B;AACA,SAASC,eAAT,QAAgC,6BAAhC;AAEA,SAASC,IAAT,QAAqB,kBAArB;AACA,IAAMC,CAAC,GAAGD,IAAI,CAACE,SAAL,CAAe,8BAAf,CAAV;;AAEA,IAAMC,iBAAiB,GAAG,SAApBA,iBAAoB,GAAM;AAAA,uBAGxBL,aAAa,EAHW;AAAA,MAEfM,IAFe,kBAExBC,KAFwB,CAEfD,IAFe;;AAAA,qBAKHP,WAAW,EALR;AAAA,MAKpBS,YALoB,gBAKpBA,YALoB;;AAAA,mBAMRZ,SAAS,EAND;AAAA,MAMpBa,OANoB,cAMpBA,OANoB;;AAQ5B,sBACI,oBAAC,kBAAD;AACI,IAAA,KAAK,EAAEN,CAAF,mBADT;AAEI,IAAA,OAAO,EAAEA,CAAF;AAFX,KAIK;AAAA,QAAGO,gBAAH,QAAGA,gBAAH;AAAA,wBACG,oBAAC,QAAD;AAAU,MAAA,QAAQ,EAAET,eAApB;AAAqC,MAAA,cAAc,EAAE,CAAC,gBAAD;AAArD,OACK,UAAAU,MAAM;AAAA,0BACH,oBAAC,aAAD;AACI,QAAA,OAAO,wEAAE;AAAA;AAAA;AAAA;AAAA;AACLD,kBAAAA,gBAAgB,wEAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mCACUC,MAAM,CAAC;AAC1BC,8BAAAA,SAAS,EAAE;AACPC,gCAAAA,EAAE,EAAEP,IAAI,CAACO;AADF;AADe,6BAAD,CADhB;;AAAA;AACPC,4BAAAA,QADO;AAOLC,4BAAAA,KAPK,GAOKD,QAAQ,CAACR,IAAT,CAAcU,KAAd,CAAoBf,eAPzB,CAOLc,KAPK;;AAAA,iCAQTA,KARS;AAAA;AAAA;AAAA;;AAAA,6DASFP,YAAY,CAACO,KAAK,CAACE,OAAP,CATV;;AAAA;AAYbR,4BAAAA,OAAO,CAACS,IAAR,qBAA0BZ,IAAI,CAACO,EAA/B,GAZa,CAcb;;AACAM,4BAAAA,UAAU,CAAC,YAAM;AACbX,8BAAAA,YAAY,CAACL,CAAD,qBAAZ;AACH,6BAFS,EAEP,GAFO,CAAV;;AAfa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAAD,GAAhB;;AADK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAF;AADX,SAuBKG,IAAI,CAACc,OAAL,GAAe,CAAf,GAAmBjB,CAAnB,uBAAwCA,CAAxC,oBAvBL,CADG;AAAA,KADX,CADH;AAAA,GAJL,CADJ;AAsCH,CA9CD;;AAgDA,eAAeE,iBAAf","sourcesContent":["import React from \"react\";\nimport { Mutation } from \"react-apollo\";\nimport { useRouter } from \"@webiny/react-router\";\nimport { ButtonPrimary } from \"@webiny/ui/Button\";\nimport { ConfirmationDialog } from \"@webiny/ui/ConfirmationDialog\";\nimport { useSnackbar } from \"@webiny/app-admin/hooks/useSnackbar\";\nimport { useFormEditor } from \"@webiny/app-form-builder/admin/components/FormEditor/Context\";\nimport { publishRevision } from \"./PublishFormButton/graphql\";\n\nimport { i18n } from \"@webiny/app/i18n\";\nconst t = i18n.namespace(\"FormEditor.PublishPageButton\");\n\nconst PublishFormButton = () => {\n    const {\n        state: { data }\n    } = useFormEditor();\n\n    const { showSnackbar } = useSnackbar();\n    const { history } = useRouter();\n\n    return (\n        <ConfirmationDialog\n            title={t`Publish form`}\n            message={t`You are about to publish this form, are you sure want to continue?`}\n        >\n            {({ showConfirmation }) => (\n                <Mutation mutation={publishRevision} refetchQueries={[\"FormsListForms\"]}>\n                    {update => (\n                        <ButtonPrimary\n                            onClick={async () => {\n                                showConfirmation(async () => {\n                                    const response = await update({\n                                        variables: {\n                                            id: data.id\n                                        }\n                                    });\n\n                                    const { error } = response.data.forms.publishRevision;\n                                    if (error) {\n                                        return showSnackbar(error.message);\n                                    }\n\n                                    history.push(`/forms?id=${data.id}`);\n\n                                    // Let's wait a bit, because we are also redirecting the user.\n                                    setTimeout(() => {\n                                        showSnackbar(t`Your form was published successfully!`);\n                                    }, 500);\n                                });\n                            }}\n                        >\n                            {data.version > 1 ? t`Publish changes` : t`Publish`}\n                        </ButtonPrimary>\n                    )}\n                </Mutation>\n            )}\n        </ConfirmationDialog>\n    );\n};\n\nexport default PublishFormButton;\n"],"file":"PublishFormButton.js"}