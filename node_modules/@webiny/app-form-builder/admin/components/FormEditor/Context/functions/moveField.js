import getFieldPosition from "./getFieldPosition";
/**
 * Remove all rows that have zero fields in it.
 * @param data
 */

var cleanupEmptyRows = function cleanupEmptyRows(data) {
  data.layout = data.layout.filter(function (row) {
    return row.length > 0;
  });
};

var moveField = function moveField(_ref) {
  var field = _ref.field,
      position = _ref.position,
      data = _ref.data;
  var row = position.row,
      index = position.index;
  var fieldId = typeof field === "string" ? field : field._id;
  var existingPosition = getFieldPosition({
    field: fieldId,
    data: data
  });

  if (existingPosition) {
    data.layout[existingPosition.row].splice(existingPosition.index, 1);
  } // Setting a form field into a new non-existing row.


  if (!data.layout[row]) {
    data.layout[row] = [fieldId];
    return;
  } // If row exists, we drop the field at the specified index.


  if (index === null) {
    // Create a new row with the new field at the given row index,
    data.layout.splice(row, 0, [fieldId]);
    return;
  }

  data.layout[row].splice(index, 0, fieldId);
};

export default (function (params) {
  moveField(params);
  cleanupEmptyRows(params.data);
});
//# sourceMappingURL=moveField.js.map