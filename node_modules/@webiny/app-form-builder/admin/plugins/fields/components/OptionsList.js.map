{"version":3,"sources":["../../../../../src/admin/plugins/fields/components/OptionsList.tsx"],"names":["React","useState","useI18N","css","styled","OptionsListItem","AddOptionInput","EditFieldOptionDialog","sortableContainer","sortableElement","sortableHandle","Icon","validation","OptionList","padding","border","OptionListItem","zIndex","display","justifyContent","borderBottom","background","sortableList","DragHandle","cursor","SortableContainer","children","SortableItem","setOptionsValue","setEditOption","option","options","optionsValue","Bind","multiple","optionIndex","value","newValue","splice","index","data","label","OptionsList","form","getDefaultLocale","editOption","clearEditOption","create","optionsValidation","onChange","Array","isArray","push","values","locale","id","position","length","oldIndex","newIndex","movedItem","map","item","textAlign"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\nimport { useI18N } from \"@webiny/app-i18n/hooks/useI18N\";\nimport { css } from \"emotion\";\nimport styled from \"@emotion/styled\";\nimport { camelCase, cloneDeep } from \"lodash\";\nimport { OptionsListItem, AddOptionInput, EditFieldOptionDialog } from \"./OptionsListComponents\";\n// @ts-ignore\nimport { sortableContainer, sortableElement, sortableHandle } from \"react-sortable-hoc\";\nimport { Icon } from \"@webiny/ui/Icon\";\nimport { ReactComponent as HandleIcon } from \"@webiny/app-form-builder/admin/icons/round-drag_indicator-24px.svg\";\nimport { validation } from \"@webiny/validation\";\nimport { FormChildrenFunctionParams } from \"@webiny/form/Form\";\n\nconst OptionList = styled(\"ul\")({\n    padding: 25,\n    border: \"1px solid var(--mdc-theme-on-background)\"\n});\n\nconst OptionListItem = styled(\"li\")({\n    zIndex: 10,\n    display: \"flex\",\n    justifyContent: \"space-between\",\n    borderBottom: \"1px solid var(--mdc-theme-background)\",\n    background: \"var(--mdc-theme-surface)\",\n    \"&:hover\": {\n        background: \"var(--mdc-theme-background)\"\n    },\n    \"&:last-child\": {\n        border: \"none\"\n    }\n});\n\nconst sortableList = css({\n    zIndex: 20\n});\n\nconst DragHandle = sortableHandle(() => (\n    <Icon icon={<HandleIcon style={{ cursor: \"pointer\" }} />} />\n));\n\nconst SortableContainer = sortableContainer(({ children }) => {\n    return <OptionList>{children}</OptionList>;\n});\n\nconst SortableItem = sortableElement(\n    ({\n        setOptionsValue,\n        setEditOption,\n        option,\n        optionsValue: options,\n        Bind,\n        multiple,\n        optionIndex\n    }) => (\n        <OptionListItem>\n            <OptionsListItem\n                dragHandle={<DragHandle />}\n                key={option.value}\n                Bind={Bind}\n                multiple={multiple}\n                option={option}\n                deleteOption={() => {\n                    const newValue = [...options];\n                    newValue.splice(optionIndex, 1);\n                    setOptionsValue(newValue);\n                }}\n                editOption={() => setEditOption({ index: optionIndex, data: cloneDeep(option) })}\n                setOptionTranslations={label => {\n                    const newValue = [...options];\n                    newValue.splice(optionIndex, 1, {\n                        value: option.value,\n                        label\n                    });\n                    setOptionsValue(newValue);\n                }}\n            />\n        </OptionListItem>\n    )\n);\n\ntype OptionsListProps = {\n    form: FormChildrenFunctionParams;\n    multiple?: boolean;\n};\n\nconst OptionsList = ({ form, multiple }: OptionsListProps) => {\n    const { Bind } = form;\n\n    const { getDefaultLocale } = useI18N();\n\n    const [editOption, setEditOption] = useState({\n        data: null,\n        index: null\n    });\n    const clearEditOption = () =>\n        setEditOption({\n            data: null,\n            index: null\n        });\n\n    return (\n        <Bind name={\"options\"} validators={validation.create(\"required,minLength:1\")}>\n            {({\n                validation: optionsValidation,\n                value: optionsValue,\n                onChange: setOptionsValue\n            }) => (\n                <>\n                    <div>Options</div>\n                    <div>\n                        <AddOptionInput\n                            options={optionsValue}\n                            validation={optionsValidation}\n                            onAdd={label => {\n                                const newValue = Array.isArray(optionsValue)\n                                    ? [...optionsValue]\n                                    : [];\n                                newValue.push({\n                                    value: camelCase(label),\n                                    label: {\n                                        values: [{ locale: getDefaultLocale().id, value: label }]\n                                    }\n                                });\n                                setOptionsValue(newValue);\n                            }}\n                        />\n                    </div>\n\n                    <div style={{ position: \"relative\" }}>\n                        {Array.isArray(optionsValue) && optionsValue.length > 0 ? (\n                            <SortableContainer\n                                helperClass={sortableList}\n                                useDragHandle\n                                transitionDuration={0}\n                                onSortEnd={({ oldIndex, newIndex }) => {\n                                    const newValue = [...optionsValue];\n                                    const [movedItem] = newValue.splice(oldIndex, 1);\n                                    newValue.splice(newIndex, 0, movedItem);\n                                    setOptionsValue(newValue);\n                                }}\n                            >\n                                {optionsValue.map((item, index) => (\n                                    <SortableItem\n                                        key={`item-${index}`}\n                                        Bind={Bind}\n                                        multiple={multiple}\n                                        setEditOption={setEditOption}\n                                        setOptionsValue={setOptionsValue}\n                                        option={item}\n                                        optionsValue={optionsValue}\n                                        optionIndex={index}\n                                        index={index}\n                                    />\n                                ))}\n                            </SortableContainer>\n                        ) : (\n                            <div style={{ padding: 40, textAlign: \"center\" }}>\n                                No options added.\n                            </div>\n                        )}\n                    </div>\n\n                    <EditFieldOptionDialog\n                        onClose={clearEditOption}\n                        open={editOption.data}\n                        options={optionsValue}\n                        option={editOption.data}\n                        optionIndex={editOption.index}\n                        onSubmit={data => {\n                            const newValue = [...optionsValue];\n                            newValue.splice(editOption.index, 1, data);\n                            setOptionsValue(newValue);\n                            clearEditOption();\n                        }}\n                    />\n                </>\n            )}\n        </Bind>\n    );\n};\n\nexport default OptionsList;\n"],"file":"OptionsList.js"}