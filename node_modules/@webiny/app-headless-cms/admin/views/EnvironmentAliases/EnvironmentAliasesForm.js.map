{"version":3,"sources":["../../../../src/admin/views/EnvironmentAliases/EnvironmentAliasesForm.tsx"],"names":["React","Form","Grid","Cell","Input","ButtonPrimary","CircularProgress","useCrud","i18n","useApolloClient","get","GET_ENVIRONMENT_ALIAS_BY_SLUG","NameSlug","AutoComplete","useCms","SimpleFormHeader","SimpleForm","SimpleFormFooter","SimpleFormContent","t","ns","EnvironmentAliasesForm","crudForm","form","environmentsOptions","environments","apolloClient","data","Bind","setValue","loading","name","id","description","query","variables","slug","getEnvironmentAliasBySlug","existingEnvironmentAlias","Error","props","submit"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { Form } from \"@webiny/form\";\nimport { Grid, Cell } from \"@webiny/ui/Grid\";\nimport { Input } from \"@webiny/ui/Input\";\nimport { ButtonPrimary } from \"@webiny/ui/Button\";\nimport { CircularProgress } from \"@webiny/ui/Progress\";\nimport { useCrud } from \"@webiny/app-admin/hooks/useCrud\";\nimport { i18n } from \"@webiny/app/i18n\";\nimport { useApolloClient } from \"react-apollo\";\nimport get from \"lodash.get\";\nimport { GET_ENVIRONMENT_ALIAS_BY_SLUG } from \"./graphql\";\nimport NameSlug from \"../../components/NameSlug\";\nimport { AutoComplete } from \"@webiny/ui/AutoComplete\";\n\nimport { useCms } from \"@webiny/app-headless-cms/admin/hooks\";\n\nimport {\n    SimpleFormHeader,\n    SimpleForm,\n    SimpleFormFooter,\n    SimpleFormContent\n} from \"@webiny/app-admin/components/SimpleForm\";\n\nconst t = i18n.ns(\"app-headless-cms/admin/environmentAliases/form\");\n\nfunction EnvironmentAliasesForm() {\n    const { form: crudForm } = useCrud();\n    const {\n        environments: { environments: environmentsOptions }\n    } = useCms();\n\n    const apolloClient = useApolloClient();\n\n    return (\n        <Form {...crudForm}>\n            {({ data, form, Bind, setValue }) => (\n                <SimpleForm data-testid={\"pb-environmentAliases-form\"}>\n                    {crudForm.loading && <CircularProgress />}\n                    <SimpleFormHeader title={data.name ? data.name : t`New environment alias`} />\n                    <SimpleFormContent>\n                        <Grid>\n                            <NameSlug\n                                newEntry={!crudForm.id}\n                                Bind={Bind}\n                                setValue={setValue}\n                                slug={{\n                                    description: t`Will be used as part of the GraphQL API URL.`\n                                }}\n                                validateSlugUniqueness={async () => {\n                                    if (data.id) {\n                                        return;\n                                    }\n\n                                    const getEnvironmentAliasBySlug = await apolloClient.query({\n                                        query: GET_ENVIRONMENT_ALIAS_BY_SLUG,\n                                        variables: {\n                                            slug: data.slug\n                                        }\n                                    });\n\n                                    const existingEnvironmentAlias = get(\n                                        getEnvironmentAliasBySlug,\n                                        \"data.cms.getEnvironmentAlias.data\"\n                                    );\n\n                                    if (existingEnvironmentAlias) {\n                                        throw new Error(\n                                            t`Environment with slug \"{slug}\" already exists.`({\n                                                slug: data.slug\n                                            })\n                                        );\n                                    }\n                                }}\n                            />\n                            <Cell span={12}>\n                                <Bind name=\"description\">\n                                    {props => (\n                                        <Input\n                                            {...props}\n                                            rows={4}\n                                            maxLength={200}\n                                            characterCount\n                                            label={t`Description`}\n                                        />\n                                    )}\n                                </Bind>\n                            </Cell>\n                            <Cell span={12}>\n                                <Bind name=\"environment\">\n                                    {props => (\n                                        <AutoComplete\n                                            {...props}\n                                            placeholder={t`No environment selected.`}\n                                            label={t`Environment`}\n                                            options={environmentsOptions}\n                                            description={t`Choose an existing environment to which this alias will point to.`}\n                                        />\n                                    )}\n                                </Bind>\n                            </Cell>\n                        </Grid>\n                    </SimpleFormContent>\n                    <SimpleFormFooter>\n                        <ButtonPrimary\n                            onClick={form.submit}\n                        >{t`Save environment alias`}</ButtonPrimary>\n                    </SimpleFormFooter>\n                </SimpleForm>\n            )}\n        </Form>\n    );\n}\n\nexport default EnvironmentAliasesForm;\n"],"file":"EnvironmentAliasesForm.js"}