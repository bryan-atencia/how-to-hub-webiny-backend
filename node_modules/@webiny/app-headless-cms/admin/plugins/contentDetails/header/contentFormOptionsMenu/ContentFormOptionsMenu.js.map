{"version":3,"sources":["../../../../../../src/admin/plugins/contentDetails/header/contentFormOptionsMenu/ContentFormOptionsMenu.tsx"],"names":["React","useCallback","useMemo","css","get","IconButton","I18NValue","Menu","MenuItem","ListItemGraphic","Icon","useRouter","useSnackbar","useDialog","createDeleteMutation","useMutation","useConfirmationDialog","i18n","t","ns","menuStyles","width","right","left","opacity","pointerEvents","ContentFormOptionsMenu","contentModel","content","dataList","getLoading","setLoading","showSnackbar","history","showDialog","DELETE_CONTENT","modelId","deleteContentMutation","title","value","message","showConfirmation","confirmDelete","variables","revision","meta","parent","res","data","refresh","error","query","URLSearchParams","location","search","delete","push","toString","id"],"mappings":"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","sourcesContent":["import React, { useCallback, useMemo } from \"react\";\nimport { css } from \"emotion\";\nimport get from \"lodash/get\";\nimport { IconButton } from \"@webiny/ui/Button\";\nimport I18NValue from \"@webiny/app-i18n/components/I18NValue\";\nimport { Menu, MenuItem } from \"@webiny/ui/Menu\";\nimport { ListItemGraphic } from \"@webiny/ui/List\";\nimport { Icon } from \"@webiny/ui/Icon\";\nimport { useRouter } from \"@webiny/react-router\";\nimport { useSnackbar } from \"@webiny/app-admin/hooks/useSnackbar\";\nimport { useDialog } from \"@webiny/app-admin/hooks/useDialog\";\nimport { createDeleteMutation } from \"@webiny/app-headless-cms/admin/components/ContentModelForm/graphql\";\nimport { useMutation } from \"@webiny/app-headless-cms/admin/hooks\";\nimport { useConfirmationDialog } from \"@webiny/app-admin/hooks/useConfirmationDialog\";\n\nimport { i18n } from \"@webiny/app/i18n\";\nconst t = i18n.ns(\n    \"app-headless-cms/admin/plugins/content-details/header/content-form-options-menu\"\n);\n\nimport { ReactComponent as MoreVerticalIcon } from \"@webiny/app-headless-cms/admin/icons/more_vert.svg\";\nimport { ReactComponent as DeleteIcon } from \"@webiny/app-headless-cms/admin/icons/delete.svg\";\n\nconst menuStyles = css({\n    width: 250,\n    right: -105,\n    left: \"auto !important\",\n    \".disabled\": {\n        opacity: 0.5,\n        pointerEvents: \"none\"\n    }\n});\n\nconst ContentFormOptionsMenu = ({ contentModel, content, dataList, getLoading, setLoading }) => {\n    const { showSnackbar } = useSnackbar();\n    const { history } = useRouter();\n    const { showDialog } = useDialog();\n\n    const DELETE_CONTENT = useMemo(() => {\n        return createDeleteMutation(contentModel);\n    }, [contentModel.modelId]);\n\n    const [deleteContentMutation] = useMutation(DELETE_CONTENT);\n\n    const title = I18NValue({ value: get(content, \"meta.title\") });\n\n    const { showConfirmation } = useConfirmationDialog({\n        title: t`Delete content entry`,\n        message: (\n            <p>\n                {t`You are about to delete this content entry and all of its revisions!\n                    Are you sure you want to permanently delete {title}?`({\n                    title: <strong>{title}</strong>\n                })}\n            </p>\n        )\n    });\n\n    const confirmDelete = useCallback(() => {\n        showConfirmation(async () => {\n            setLoading(true);\n            const { data: res } = await deleteContentMutation({\n                variables: { revision: content.meta.parent }\n            });\n\n            setLoading(false);\n\n            dataList.refresh();\n\n            const { error } = get(res, \"content\");\n            if (error) {\n                return showDialog(error.message, { title: t`Could not delete content` });\n            }\n\n            showSnackbar(t`{title} was deleted successfully!`({ title: <strong>{title}</strong> }));\n\n            const query = new URLSearchParams(location.search);\n            query.delete(\"id\");\n            history.push({ search: query.toString() });\n        });\n    }, null);\n\n    return (\n        <Menu className={menuStyles} handle={<IconButton icon={<MoreVerticalIcon />} />}>\n            <MenuItem onClick={confirmDelete} disabled={!content.id || getLoading()}>\n                <ListItemGraphic>\n                    <Icon icon={<DeleteIcon />} />\n                </ListItemGraphic>\n                Delete\n            </MenuItem>\n        </Menu>\n    );\n};\n\nexport default ContentFormOptionsMenu;\n"],"file":"ContentFormOptionsMenu.js"}