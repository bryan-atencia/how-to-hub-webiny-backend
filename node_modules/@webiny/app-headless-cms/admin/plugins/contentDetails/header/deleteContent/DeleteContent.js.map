{"version":3,"sources":["../../../../../../src/admin/plugins/contentDetails/header/deleteContent/DeleteContent.tsx"],"names":["React","useCallback","useMemo","useRouter","useSnackbar","useConfirmationDialog","useDialog","IconButton","Tooltip","createDeleteMutation","useMutation","I18NValue","get","i18n","t","ns","DeleteContent","contentModel","content","dataList","getLoading","setLoading","showSnackbar","history","showDialog","DELETE_CONTENT","modelId","deleteContentMutation","title","value","message","showConfirmation","confirmDelete","variables","revision","meta","parent","res","data","refresh","error","query","URLSearchParams","location","search","delete","push","toString","id"],"mappings":"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","sourcesContent":["import React, { useCallback, useMemo } from \"react\";\nimport { useRouter } from \"@webiny/react-router\";\nimport { useSnackbar } from \"@webiny/app-admin/hooks/useSnackbar\";\nimport { useConfirmationDialog } from \"@webiny/app-admin/hooks/useConfirmationDialog\";\nimport { useDialog } from \"@webiny/app-admin/hooks/useDialog\";\nimport { IconButton } from \"@webiny/ui/Button\";\nimport { Tooltip } from \"@webiny/ui/Tooltip\";\nimport { ReactComponent as DeleteIcon } from \"@webiny/app-headless-cms/admin/icons/delete.svg\";\nimport { createDeleteMutation } from \"@webiny/app-headless-cms/admin/components/ContentModelForm/graphql\";\nimport { useMutation } from \"@webiny/app-headless-cms/admin/hooks\";\nimport I18NValue from \"@webiny/app-i18n/components/I18NValue\";\nimport get from \"lodash/get\";\nimport { i18n } from \"@webiny/app/i18n\";\nconst t = i18n.ns(\"app-headless-cms/admin/plugins/content/header/delete\");\n\nconst DeleteContent = ({ contentModel, content, dataList, getLoading, setLoading }) => {\n    const { showSnackbar } = useSnackbar();\n    const { history } = useRouter();\n    const { showDialog } = useDialog();\n\n    const DELETE_CONTENT = useMemo(() => {\n        return createDeleteMutation(contentModel);\n    }, [contentModel.modelId]);\n\n    const [deleteContentMutation] = useMutation(DELETE_CONTENT);\n\n    const title = I18NValue({ value: get(content, \"meta.title\") });\n\n    const { showConfirmation } = useConfirmationDialog({\n        title: t`Delete content entry`,\n        message: (\n            <p>\n                {t`You are about to delete this content entry and all of its revisions!\n                    Are you sure you want to permanently delete {title}?`({\n                    title: <strong>{title}</strong>\n                })}\n            </p>\n        )\n    });\n\n    const confirmDelete = useCallback(() => {\n        showConfirmation(async () => {\n            setLoading(true);\n            const { data: res } = await deleteContentMutation({\n                variables: { revision: content.meta.parent }\n            });\n\n            setLoading(false);\n\n            dataList.refresh();\n\n            const { error } = get(res, \"content\");\n            if (error) {\n                return showDialog(error.message, { title: t`Could not delete content` });\n            }\n\n            showSnackbar(t`{title} was deleted successfully!`({ title: <strong>{title}</strong> }));\n\n            const query = new URLSearchParams(location.search);\n            query.delete(\"id\");\n            history.push({ search: query.toString() });\n        });\n    }, null);\n\n    return (\n        <Tooltip content={t`Delete`} placement={\"top\"}>\n            <IconButton\n                icon={<DeleteIcon />}\n                onClick={confirmDelete}\n                disabled={!content.id || getLoading()}\n            />\n        </Tooltip>\n    );\n};\n\nexport default DeleteContent;\n"],"file":"DeleteContent.js"}