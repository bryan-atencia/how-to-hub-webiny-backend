{"version":3,"sources":["../../../../../../src/admin/plugins/contentDetails/header/publishRevision/PublishRevision.tsx"],"names":["React","useCallback","useMemo","IconButton","Tooltip","useSnackbar","createPublishMutation","useMutation","i18n","useConfirmationDialog","t","ns","PublishRevision","content","contentModel","getLoading","setLoading","revisionsList","showSnackbar","PUBLISH_CONTENT","modelId","publishContentMutation","onPublish","variables","revision","id","response","contentData","error","message","refetch","title","showConfirmation"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,WAAhB,EAA6BC,OAA7B,QAA4C,OAA5C;AACA,SAASC,UAAT,QAA2B,mBAA3B;AACA,SAASC,OAAT,QAAwB,oBAAxB;;AAGA,SAASC,WAAT,QAA4B,qCAA5B;AACA,SAASC,qBAAT,QAAsC,oEAAtC;AACA,SAASC,WAAT,QAA4B,sCAA5B;AACA,SAASC,IAAT,QAAqB,kBAArB;AACA,SAASC,qBAAT,QAAsC,+CAAtC;AAEA,IAAMC,CAAC,GAAGF,IAAI,CAACG,EAAL,CAAQ,wEAAR,CAAV;;AAEA,IAAMC,eAAe,GAAG,SAAlBA,eAAkB,OAAsE;AAAA,MAAnEC,OAAmE,QAAnEA,OAAmE;AAAA,MAA1DC,YAA0D,QAA1DA,YAA0D;AAAA,MAA5CC,UAA4C,QAA5CA,UAA4C;AAAA,MAAhCC,UAAgC,QAAhCA,UAAgC;AAAA,MAApBC,aAAoB,QAApBA,aAAoB;;AAAA,qBACjEZ,WAAW,EADsD;AAAA,MAClFa,YADkF,gBAClFA,YADkF;;AAAA,iBAG9DhB,OAAO,CAAC,YAAM;AACtC,WAAO;AACHiB,MAAAA,eAAe,EAAEb,qBAAqB,CAACQ,YAAD;AADnC,KAAP;AAGH,GAJkC,EAIhC,CAACA,YAAY,CAACM,OAAd,CAJgC,CAHuD;AAAA,MAGlFD,eAHkF,YAGlFA,eAHkF;;AAAA,qBASzDZ,WAAW,CAACY,eAAD,CAT8C;AAAA;AAAA,MASnFE,sBATmF;;AAW1F,MAAMC,SAAS,GAAGrB,WAAW,wEAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAC1Be,YAAAA,UAAU,CAAC,IAAD,CAAV;AAD0B;AAAA,mBAEHK,sBAAsB,CAAC;AAC1CE,cAAAA,SAAS,EAAE;AAAEC,gBAAAA,QAAQ,EAAEX,OAAO,CAACY;AAApB;AAD+B,aAAD,CAFnB;;AAAA;AAEpBC,YAAAA,QAFoB;AAMpBC,YAAAA,WANoB,GAMN,KAAID,QAAJ,EAAc,cAAd,CANM;AAO1BV,YAAAA,UAAU,CAAC,KAAD,CAAV;;AAP0B,iBAQtBW,WAAW,CAACC,KARU;AAAA;AAAA;AAAA;;AAAA,6CASfV,YAAY,CAACS,WAAW,CAACC,KAAZ,CAAkBC,OAAnB,CATG;;AAAA;AAY1BX,YAAAA,YAAY,CAACR,CAAD,oBAAZ;AACAO,YAAAA,aAAa,CAACa,OAAd;;AAb0B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAD,IAc1B,CAACjB,OAAO,CAACY,EAAT,CAd0B,CAA7B;;AAX0F,8BA2B7DhB,qBAAqB,CAAC;AAC/CsB,IAAAA,KAAK,EAAErB,CAAF,oBAD0C;AAE/CmB,IAAAA,OAAO,eACH,+BAAInB,CAAJ;AAH2C,GAAD,CA3BwC;AAAA,MA2BlFsB,gBA3BkF,yBA2BlFA,gBA3BkF;;AAkC1F,sBACI,oBAAC,KAAD,CAAO,QAAP,qBACI,oBAAC,OAAD;AAAS,IAAA,OAAO,EAAEtB,CAAF,oBAAhB;AAA8B,IAAA,SAAS,EAAE;AAAzC,kBACI,oBAAC,UAAD;AACI,IAAA,IAAI,eAAE,oBAAC,WAAD,OADV;AAEI,IAAA,OAAO,EAAE;AAAA,aAAMsB,gBAAgB,CAACV,SAAD,CAAtB;AAAA,KAFb;AAGI,IAAA,QAAQ,EAAE,CAACT,OAAO,CAACY,EAAT,IAAeV,UAAU;AAHvC,IADJ,CADJ,CADJ;AAWH,CA7CD;;AA+CA,eAAeH,eAAf","sourcesContent":["import React, { useCallback, useMemo } from \"react\";\nimport { IconButton } from \"@webiny/ui/Button\";\nimport { Tooltip } from \"@webiny/ui/Tooltip\";\nimport { ReactComponent as PublishIcon } from \"@webiny/app-headless-cms/admin/icons/publish.svg\";\nimport { get } from \"lodash\";\nimport { useSnackbar } from \"@webiny/app-admin/hooks/useSnackbar\";\nimport { createPublishMutation } from \"@webiny/app-headless-cms/admin/components/ContentModelForm/graphql\";\nimport { useMutation } from \"@webiny/app-headless-cms/admin/hooks\";\nimport { i18n } from \"@webiny/app/i18n\";\nimport { useConfirmationDialog } from \"@webiny/app-admin/hooks/useConfirmationDialog\";\n\nconst t = i18n.ns(\"app-headless-cms/admin/plugins/content-details/header/publish-revision\");\n\nconst PublishRevision = ({ content, contentModel, getLoading, setLoading, revisionsList }) => {\n    const { showSnackbar } = useSnackbar();\n\n    const { PUBLISH_CONTENT } = useMemo(() => {\n        return {\n            PUBLISH_CONTENT: createPublishMutation(contentModel)\n        };\n    }, [contentModel.modelId]);\n\n    const [publishContentMutation] = useMutation(PUBLISH_CONTENT);\n\n    const onPublish = useCallback(async () => {\n        setLoading(true);\n        const response = await publishContentMutation({\n            variables: { revision: content.id }\n        });\n\n        const contentData = get(response, \"data.content\");\n        setLoading(false);\n        if (contentData.error) {\n            return showSnackbar(contentData.error.message);\n        }\n\n        showSnackbar(t`Content published successfully.`);\n        revisionsList.refetch();\n    }, [content.id]);\n\n    const { showConfirmation } = useConfirmationDialog({\n        title: t`Publish content`,\n        message: (\n            <p>{t`You are about to publish a new revision. Are you sure you want to continue?`}</p>\n        )\n    });\n\n    return (\n        <React.Fragment>\n            <Tooltip content={t`Publish`} placement={\"top\"}>\n                <IconButton\n                    icon={<PublishIcon />}\n                    onClick={() => showConfirmation(onPublish)}\n                    disabled={!content.id || getLoading()}\n                />\n            </Tooltip>\n        </React.Fragment>\n    );\n};\n\nexport default PublishRevision;\n"],"file":"PublishRevision.js"}