{"version":3,"sources":["../../../../../src/admin/plugins/contentDetails/contentRevisions/Revision.tsx"],"names":["React","css","TimeAgo","ListItem","ListItemText","ListItemTextPrimary","ListItemTextSecondary","ListItemGraphic","ListItemMeta","IconButton","Icon","MenuItem","Menu","MenuDivider","ConfirmationDialog","Tooltip","useRouter","I18NValue","i18n","t","ns","primaryColor","color","revisionsMenu","width","right","left","getIcon","rev","meta","locked","published","icon","text","Revision","props","revision","createContentFrom","deleteContent","publishContent","switchTab","tooltipText","history","version","showConfirmation","title","time","savedOn","id","query","URLSearchParams","location","search","set","push","toString","parent"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { css } from \"emotion\";\nimport TimeAgo from \"timeago-react\";\nimport {\n    ListItem,\n    ListItemText,\n    ListItemTextPrimary,\n    ListItemTextSecondary,\n    ListItemGraphic,\n    ListItemMeta\n} from \"@webiny/ui/List\";\nimport { IconButton } from \"@webiny/ui/Button\";\nimport { Icon } from \"@webiny/ui/Icon\";\nimport { MenuItem, Menu, MenuDivider } from \"@webiny/ui/Menu\";\nimport { ConfirmationDialog } from \"@webiny/ui/ConfirmationDialog\";\nimport { Tooltip } from \"@webiny/ui/Tooltip\";\nimport { ReactComponent as MoreVerticalIcon } from \"@webiny/app-headless-cms/admin/icons/more_vert.svg\";\nimport { ReactComponent as LockIcon } from \"@webiny/app-headless-cms/admin/icons/lock.svg\";\nimport { ReactComponent as BeenHereIcon } from \"@webiny/app-headless-cms/admin/icons/beenhere.svg\";\nimport { ReactComponent as GestureIcon } from \"@webiny/app-headless-cms/admin/icons/gesture.svg\";\nimport { ReactComponent as AddIcon } from \"@webiny/app-headless-cms/admin/icons/add.svg\";\nimport { ReactComponent as EditIcon } from \"@webiny/app-headless-cms/admin/icons/edit.svg\";\nimport { ReactComponent as PublishIcon } from \"@webiny/app-headless-cms/admin/icons/publish.svg\";\nimport { ReactComponent as DeleteIcon } from \"@webiny/app-headless-cms/admin/icons/delete.svg\";\nimport { useRouter } from \"@webiny/react-router\";\nimport { CmsEditorContentModel } from \"@webiny/app-headless-cms/types\";\nimport { I18NValue } from \"@webiny/app-i18n/components\";\nimport { i18n } from \"@webiny/app/i18n\";\n\nconst t = i18n.ns(\"app-headless-cms/admin/plugins/content-details/content-revisions\");\n\nconst primaryColor = css({ color: \"var(--mdc-theme-primary)\" });\n\nconst revisionsMenu = css({\n    width: 250,\n    right: -105,\n    left: \"auto !important\"\n});\n\nconst getIcon = (rev: CmsEditorContentModel) => {\n    switch (true) {\n        case rev.meta.locked && !rev.meta.published:\n            return {\n                icon: <Icon icon={<LockIcon />} />,\n                text: \"This revision is locked (it has already been published)\"\n            };\n        case rev.meta.published:\n            return {\n                icon: <Icon icon={<BeenHereIcon />} className={primaryColor} />,\n                text: \"This revision is currently published!\"\n            };\n        default:\n            return {\n                icon: <Icon icon={<GestureIcon />} />,\n                text: \"This is a draft\"\n            };\n    }\n};\n\nconst Revision = props => {\n    const { revision, createContentFrom, deleteContent, publishContent, switchTab } = props;\n    const { icon, text: tooltipText } = getIcon(revision);\n\n    const { history } = useRouter();\n\n    return (\n        <ConfirmationDialog\n            title={t`Confirmation required!`}\n            message={\n                <span>\n                    {t`You are about to delete revision {revision}. Are you sure you want to continue?`(\n                        { revision: <strong>#{revision.meta.version}</strong> }\n                    )}\n                </span>\n            }\n        >\n            {({ showConfirmation }) => (\n                <ListItem>\n                    <ListItemGraphic>\n                        <Tooltip content={tooltipText} placement={\"bottom\"}>\n                            {icon}\n                        </Tooltip>\n                    </ListItemGraphic>\n                    <ListItemText>\n                        <ListItemTextPrimary>\n                            <I18NValue value={revision.meta.title} default={t`N/A`} />\n                        </ListItemTextPrimary>\n                        <ListItemTextSecondary>\n                            {t`Last modified: {time} (#{version})`({\n                                time: <TimeAgo datetime={revision.savedOn} />,\n                                version: revision.meta.version\n                            })}\n                        </ListItemTextSecondary>\n                    </ListItemText>\n                    <ListItemMeta>\n                        <Menu\n                            handle={<IconButton icon={<MoreVerticalIcon />} />}\n                            className={revisionsMenu}\n                        >\n                            <MenuItem onClick={() => createContentFrom(revision)}>\n                                <ListItemGraphic>\n                                    <Icon icon={<AddIcon />} />\n                                </ListItemGraphic>\n                                {t`New from current`}\n                            </MenuItem>\n\n                            {!revision.meta.locked && (\n                                <MenuItem\n                                    onClick={() => {\n                                        const { id } = revision;\n                                        const query = new URLSearchParams(location.search);\n                                        query.set(\"id\", id);\n                                        history.push({ search: query.toString() });\n                                        switchTab(0);\n                                    }}\n                                >\n                                    <ListItemGraphic>\n                                        <Icon icon={<EditIcon />} />\n                                    </ListItemGraphic>\n                                    {t` Edit`}\n                                </MenuItem>\n                            )}\n\n                            {!revision.meta.published && (\n                                <MenuItem onClick={() => publishContent(revision)}>\n                                    <ListItemGraphic>\n                                        <Icon icon={<PublishIcon />} />\n                                    </ListItemGraphic>\n                                    {t`Publish`}\n                                </MenuItem>\n                            )}\n\n                            {!revision.meta.locked && revision.id !== revision.meta.parent && (\n                                <div>\n                                    <MenuDivider />\n                                    <MenuItem\n                                        onClick={() =>\n                                            showConfirmation(() => deleteContent(revision))\n                                        }\n                                    >\n                                        <ListItemGraphic>\n                                            <Icon icon={<DeleteIcon />} />\n                                        </ListItemGraphic>\n                                        {t` Delete`}\n                                    </MenuItem>\n                                </div>\n                            )}\n                        </Menu>\n                    </ListItemMeta>\n                </ListItem>\n            )}\n        </ConfirmationDialog>\n    );\n};\n\nexport default Revision;\n"],"file":"Revision.js"}