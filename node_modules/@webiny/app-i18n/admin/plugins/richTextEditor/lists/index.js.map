{"version":3,"sources":["../../../../../src/admin/plugins/richTextEditor/lists/index.tsx"],"names":["React","isKeyHotkey","Editor","Transforms","isListHotkey","LIST_TYPES","isBlockActive","editor","format","nodes","match","n","type","toggleBlock","isActive","isList","includes","unwrapNodes","split","setNodes","block","children","wrapNodes","plugins","name","plugin","menu","render","MenuButton","onKeyDown","next","event","preventDefault","renderElement","attributes","element"],"mappings":"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","sourcesContent":["import * as React from \"react\";\nimport { isKeyHotkey } from \"is-hotkey\";\nimport { Editor, Transforms } from \"slate\";\nimport { ReactComponent as FormatUnOrderedListIcon } from \"@webiny/app-i18n/admin/assets/icons/format_list_bulleted.svg\";\nimport { ReactComponent as FormatOrderedListIcon } from \"@webiny/app-i18n/admin/assets/icons/format_list_numbered.svg\";\nimport { I18NInputRichTextEditorPlugin } from \"@webiny/app-i18n/types\";\n\nconst isListHotkey = isKeyHotkey(\"mod+l\");\nconst LIST_TYPES = [\"ordered-list\", \"unordered-list\"];\n\nconst isBlockActive = (editor, format) => {\n    const [match] = Editor.nodes(editor, {\n        match: n => n.type === format\n    });\n\n    return !!match;\n};\n\nconst toggleBlock = (editor, format) => {\n    const isActive = isBlockActive(editor, format);\n    const isList = LIST_TYPES.includes(format);\n\n    Transforms.unwrapNodes(editor, {\n        match: n => LIST_TYPES.includes(n.type as string),\n        split: true\n    });\n\n    Transforms.setNodes(editor, {\n        type: isActive ? \"paragraph\" : isList ? \"list-item\" : format\n    });\n\n    if (!isActive && isList) {\n        const block = { type: format, children: [] };\n        Transforms.wrapNodes(editor, block);\n    }\n};\n\nconst plugins: I18NInputRichTextEditorPlugin[] = [\n    {\n        name: \"i18n-input-rich-text-editor-unordered-list\",\n        type: \"i18n-input-rich-text-editor\",\n        plugin: {\n            name: \"unordered-list\",\n            menu: {\n                render({ MenuButton, editor }) {\n                    const isActive = isBlockActive(editor, \"unordered-list\");\n\n                    return (\n                        <MenuButton\n                            onClick={() => toggleBlock(editor, \"unordered-list\")}\n                            active={isActive}\n                        >\n                            <FormatUnOrderedListIcon />\n                        </MenuButton>\n                    );\n                }\n            },\n            editor: {\n                onKeyDown({ event, editor }, next) {\n                    if (isListHotkey(event)) {\n                        event.preventDefault();\n                        return toggleBlock(editor, \"unordered-list\");\n                    }\n\n                    return next();\n                },\n                renderElement({ attributes, children, element }, next) {\n                    switch (element.type) {\n                        case \"unordered-list\":\n                            return (\n                                <ul\n                                    className={\"webiny-rich-typography-unordered-list\"}\n                                    {...attributes}\n                                >\n                                    {children}\n                                </ul>\n                            );\n                        case \"list-item\":\n                            return <li {...attributes}>{children}</li>;\n                        default:\n                            return next();\n                    }\n                }\n            }\n        }\n    },\n    {\n        name: \"i18n-input-rich-text-editor-ordered-list\",\n        type: \"i18n-input-rich-text-editor\",\n        plugin: {\n            name: \"ordered-list\",\n            menu: {\n                render({ MenuButton, editor }) {\n                    const isActive = isBlockActive(editor, \"ordered-list\");\n\n                    return (\n                        <MenuButton\n                            onClick={() => toggleBlock(editor, \"ordered-list\")}\n                            active={isActive}\n                        >\n                            <FormatOrderedListIcon />\n                        </MenuButton>\n                    );\n                }\n            },\n            editor: {\n                onKeyDown({ event, editor }, next) {\n                    if (isListHotkey(event)) {\n                        event.preventDefault();\n                        return toggleBlock(editor, \"ordered-list\");\n                    }\n\n                    return next();\n                },\n                renderElement({ attributes, children, element }, next) {\n                    switch (element.type) {\n                        case \"ordered-list\":\n                            return (\n                                <ol\n                                    className={\"webiny-rich-typography-ordered-list\"}\n                                    {...attributes}\n                                >\n                                    {children}\n                                </ol>\n                            );\n                        case \"list-item\":\n                            return <li {...attributes}>{children}</li>;\n                        default:\n                            return next();\n                    }\n                }\n            }\n        }\n    }\n];\n\nexport default plugins;\n"],"file":"index.js"}