{"version":3,"sources":["../src/DefaultFormLayout.tsx"],"names":["React","useState","Input","Select","Radio","Checkbox","Textarea","Form","I18NValue","HelperMessage","validation","DefaultFormLayout","getFields","getDefaultValues","submit","formData","ReCaptcha","TermsOfService","loading","setLoading","formSuccess","setFormSuccess","fields","submitForm","data","result","error","renderFieldCell","field","Bind","_id","fieldId","validators","bind","renderFieldElement","renderHiddenField","props","type","value","renderReCaptcha","errorMessage","create","onChange","isValid","renderTermsOfService","message","Boolean","renderSuccessMessage","settings","successMessage","renderSubmitButton","tosAccepted","buttonLabel","map","row","rowIndex","submitButtonLabel"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\nimport Input from \"./fields/Input\";\nimport Select from \"./fields/Select\";\nimport Radio from \"./fields/Radio\";\nimport Checkbox from \"./fields/Checkbox\";\nimport Textarea from \"./fields/Textarea\";\nimport { BindComponentRenderProp, Form } from \"@webiny/form\";\nimport { I18NValue } from \"@webiny/app-i18n/components\";\nimport HelperMessage from \"./components/HelperMessage\";\nimport { FbFormModelField, FormLayoutComponent } from \"@webiny/app-form-builder/types\";\nimport { validation } from \"@webiny/validation\";\n\n/**\n * This is the default form layout component, in which we render all the form fields. We also render terms of service\n * and reCAPTCHA (if enabled in form settings), and at the bottom, the submit button. Note that we also utilized\n * the \"webiny-form\" package, which makes working with forms and form fields a walk in the park. Also, as labels for\n * various parts of the form can be translated to different languages via the Form Editor (eg. submit button's label,\n * terms of service message...), we use the I18NValue component, which is a part of the \"webiny-app-i18n\" package.\n *\n * Feel free to use this component as your starting point for your own form layouts. Add or remove things as you like!\n */\nconst DefaultFormLayout: FormLayoutComponent = ({\n    getFields,\n    getDefaultValues,\n    submit,\n    formData,\n    ReCaptcha,\n    TermsOfService\n}) => {\n    // Is the form in loading (submitting) state?\n    const [loading, setLoading] = useState(false);\n\n    // Is the form successfully submitted?\n    const [formSuccess, setFormSuccess] = useState(false);\n\n    // All form fields - an array of rows where each row is an array that contain fields.\n    const fields = getFields();\n\n    /**\n     * Once the data is successfully submitted, we show a success message.\n     */\n    const submitForm = async data => {\n        setLoading(true);\n        const result = await submit(data);\n        setLoading(false);\n        if (result.error === null) {\n            setFormSuccess(true);\n        }\n    };\n\n    /**\n     * Renders a field cell with a field element inside.\n     */\n    const renderFieldCell = (field, Bind) => {\n        return (\n            <div\n                key={field._id}\n                className={\n                    \"webiny-pb-base-page-element-style webiny-pb-layout-column webiny-fb-form-layout-column\"\n                }\n            >\n                <Bind name={field.fieldId} validators={field.validators}>\n                    {bind => (\n                        <React.Fragment>\n                            {/* Render element */}\n                            {renderFieldElement({\n                                field,\n                                bind\n                            })}\n                        </React.Fragment>\n                    )}\n                </Bind>\n            </div>\n        );\n    };\n\n    /**\n     * Renders hidden fields.\n     */\n    const renderHiddenField = (field, Bind) => {\n        return (\n            <Bind name={field.fieldId} validators={field.validators}>\n                {bind => (\n                    <React.Fragment>\n                        {/* Render input */}\n                        {renderFieldElement({\n                            field,\n                            bind\n                        })}\n                    </React.Fragment>\n                )}\n            </Bind>\n        );\n    };\n\n    /**\n     * Renders a single form field. You can add additional handling of other field types if needed.\n     * All of these components are located in the \"./fields\" folder.\n     */\n    const renderFieldElement = (props: {\n        field: FbFormModelField;\n        bind: BindComponentRenderProp;\n    }) => {\n        switch (props.field.type) {\n            case \"text\":\n                return <Input {...props} />;\n            case \"textarea\":\n                return <Textarea {...props} />;\n            case \"number\":\n                return <Input {...props} type=\"number\" />;\n            case \"select\":\n                return <Select {...props} />;\n            case \"radio\":\n                return <Radio {...props} />;\n            case \"checkbox\":\n                return <Checkbox {...props} />;\n            case \"hidden\":\n                return <input type=\"hidden\" value={props.bind.value} />;\n            default:\n                return <span>Cannot render field.</span>;\n        }\n    };\n\n    /**\n     * Renders Google reCAPTCHA field (checkbox) - to protect us from spam and bots.\n     * For this we use the provided ReCaptcha component, which is a render prop component and a regular component\n     * at the same time, depending if the function was passed as its children. If no children are present, then\n     * it will render the actual Google reCAPTCHA field.\n     * Note that you don't have to worry if the reCAPTCHA was actually enabled via the Form Editor - the component\n     * does necessary checks internally and will not render anything if it isn't supposed to.\n     */\n    const renderReCaptcha = Bind => {\n        return (\n            <ReCaptcha>\n                {({ errorMessage }) => (\n                    <div className=\"webiny-fb-form-recaptcha\">\n                        <Bind name={\"reCaptcha\"} validators={validation.create(\"required\")}>\n                            {({ onChange, validation }) => (\n                                <>\n                                    <ReCaptcha onChange={onChange} />\n                                    <HelperMessage\n                                        isValid={validation.isValid}\n                                        errorMessage={<I18NValue value={errorMessage} />}\n                                    />\n                                </>\n                            )}\n                        </Bind>\n                    </div>\n                )}\n            </ReCaptcha>\n        );\n    };\n\n    /**\n     * Renders the Terms of Service checkbox - which forces the user to agree to our Terms of Service\n     * before actually submitting the form.\n     * For this we use the provided TermsOfService component, which is a simple render prop component.\n     * Note that you don't have to worry if the terms of service option was actually enabled via the Form Editor -\n     * the component does necessary checks internally and will not render anything if it isn't supposed to.\n     */\n    const renderTermsOfService = Bind => {\n        return (\n            <TermsOfService>\n                {({ message, errorMessage, onChange }) => (\n                    <div className=\"webiny-fb-form-tos\">\n                        <Bind\n                            name={\"tosAccepted\"}\n                            validators={validation.create(\"required\")}\n                            afterChange={onChange}\n                        >\n                            {({ onChange, value, validation }) => (\n                                <div className=\"webiny-fb-form-field webiny-fb-form-field--checkbox\">\n                                    <div className=\"webiny-fb-form-field__checkbox-group\">\n                                        <div className=\"webiny-fb-form-field__checkbox\">\n                                            <input\n                                                className=\"webiny-fb-form-field__checkbox-input\"\n                                                type={\"checkbox\"}\n                                                name=\"webiny-tos-checkbox\"\n                                                id=\"webiny-tos-checkbox\"\n                                                checked={Boolean(value)}\n                                                onChange={() => onChange(!value)}\n                                            />\n                                            <label\n                                                htmlFor={\"webiny-tos-checkbox\"}\n                                                className=\"webiny-fb-form-field__checkbox-label\"\n                                            >\n                                                <I18NValue value={message} />\n                                            </label>\n                                        </div>\n                                    </div>\n                                    <HelperMessage\n                                        isValid={validation.isValid}\n                                        errorMessage={<I18NValue value={errorMessage} />}\n                                    />\n                                </div>\n                            )}\n                        </Bind>\n                    </div>\n                )}\n            </TermsOfService>\n        );\n    };\n\n    /**\n     * Renders the success message.\n     */\n    const renderSuccessMessage = () => {\n        return (\n            <div\n                className={\n                    \"webiny-pb-base-page-element-style webiny-pb-layout-row webiny-fb-form-layout-row\"\n                }\n            >\n                <div\n                    className={\n                        \"webiny-pb-base-page-element-style webiny-pb-layout-column webiny-fb-form-layout-column\"\n                    }\n                >\n                    <div className=\"webiny-fb-form-form__success-message\">\n                        <div className=\"webiny-fb-form-field__label webiny-pb-typography-h3\">\n                            <I18NValue value={formData.settings.successMessage} default=\"Thanks!\" />\n                        </div>\n                    </div>\n                </div>\n            </div>\n        );\n    };\n\n    /**\n     * Renders the form submit button. We disable the button if the form is in the loading state.\n     */\n    const renderSubmitButton = (submit, loading, tosAccepted, buttonLabel) => {\n        return (\n            <div className=\"webiny-fb-form-submit-button\">\n                <button\n                    className={\n                        \"webiny-fb-form-page-element-button webiny-pb-page-element-button webiny-pb-page-element-button--primary\" +\n                        (loading ? \" webiny-pb-element-button--loading\" : \"\")\n                    }\n                    onClick={submit}\n                    disabled={loading}\n                >\n                    <I18NValue value={buttonLabel} default=\"Submit\" />\n                </button>\n            </div>\n        );\n    };\n\n    return (\n        /* \"onSubmit\" callback gets triggered once all of the fields are valid. */\n        /* We also pass the default values for all fields via the getDefaultValues callback. */\n        <Form onSubmit={submitForm} data={getDefaultValues()}>\n            {({ submit, Bind, data }) => (\n                <div className={\"webiny-fb-form\"}>\n                    {formSuccess ? (\n                        renderSuccessMessage()\n                    ) : (\n                        <>\n                            {/* Let's render all form fields. */}\n                            <div>\n                                {fields.map((row, rowIndex) => (\n                                    <div\n                                        key={rowIndex}\n                                        className={\n                                            \"webiny-pb-base-page-element-style webiny-pb-layout-row webiny-fb-form-layout-row\"\n                                        }\n                                    >\n                                        {/* render form fields */}\n                                        {row.map(field =>\n                                            field.type !== \"hidden\"\n                                                ? renderFieldCell(field, Bind)\n                                                : renderHiddenField(field, Bind)\n                                        )}\n                                    </div>\n                                ))}\n                            </div>\n\n                            {/*\n                                At the bottom of the Form, we render the terms of service,\n                                the reCAPTCHA field and the submit button.\n                            */}\n                            {renderTermsOfService(Bind)}\n                            {renderReCaptcha(Bind)}\n                            {renderSubmitButton(\n                                submit,\n                                loading,\n                                data.tosAccepted,\n                                formData.settings.submitButtonLabel\n                            )}\n                        </>\n                    )}\n                </div>\n            )}\n        </Form>\n    );\n};\n\nexport default DefaultFormLayout;\n"],"file":"DefaultFormLayout.js"}