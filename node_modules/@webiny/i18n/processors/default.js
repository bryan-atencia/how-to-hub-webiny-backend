"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _has2 = _interopRequireDefault(require("lodash/has"));

var _trim2 = _interopRequireDefault(require("lodash/trim"));

var _startsWith2 = _interopRequireDefault(require("lodash/startsWith"));

const processTextPart = (part, values, modifiers) => {
  if (!(0, _startsWith2.default)(part, "{")) {
    return part;
  }

  const parts = (0, _trim2.default)(part, "{}").split("|");
  const [variable, modifier] = parts;

  if (!(0, _has2.default)(values, variable)) {
    return `{${variable}}`;
  }

  const output = {
    value: values[variable]
  };

  if (modifier) {
    const parameters = modifier.split(":");
    const name = parameters.shift();

    if (modifiers[name]) {
      const modifier = modifiers[name];
      output.value = modifier.execute(output.value, parameters);
    }
  }

  return output.value;
};

const processor = {
  name: "default",

  canExecute(data) {
    for (const key in data.values) {
      const value = data.values[key];

      if (typeof value === "string" || typeof value === "number" || value === null || value instanceof Date) {
        continue;
      }

      return false;
    }

    return true;
  },

  execute(data) {
    const parts = data.translation.split(/({.*?})/);
    return parts.reduce((carry, part) => carry + processTextPart(part, data.values, data.i18n.modifiers), "");
  }

};
var _default = processor;
exports.default = _default;
//# sourceMappingURL=default.js.map