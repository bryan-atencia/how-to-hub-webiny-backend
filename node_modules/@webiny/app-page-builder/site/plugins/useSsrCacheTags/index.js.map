{"version":3,"sources":["../../../../src/site/plugins/useSsrCacheTags/index.tsx"],"names":["React","InvalidateExpiredSsrCache","useEffect","window","location","hostname","setTimeout","fetch","origin","method","headers","Accept","body","JSON","stringify","ssr","path","pathname","search","expired","refresh","type","name","component"],"mappings":"AAAA,OAAO,KAAKA,KAAZ,MAAuB,OAAvB;;AAGA,IAAMC,yBAAyB,GAAG,SAA5BA,yBAA4B,GAAM;AACpCD,EAAAA,KAAK,CAACE,SAAN,CAAgB,YAAM;AAClB,QAAI,CAACC,MAAL,EAAa;AACT;AACH;;AAED,QAAIA,MAAM,CAACC,QAAP,CAAgBC,QAAhB,KAA6B,WAAjC,EAA8C;AAC1C;AACH;;AAEDC,IAAAA,UAAU,CAAC,YAAM;AACbH,MAAAA,MAAM,CAACI,KAAP,CAAaJ,MAAM,CAACC,QAAP,CAAgBI,MAA7B,EAAqC;AACjCC,QAAAA,MAAM,EAAE,MADyB;AAEjCC,QAAAA,OAAO,EAAE;AACLC,UAAAA,MAAM,EAAE,kBADH;AAEL,0BAAgB;AAFX,SAFwB;AAMjCC,QAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;AACjBC,UAAAA,GAAG,EAAE,CACD,0BADC,EAED;AACIC,YAAAA,IAAI,EAAEb,MAAM,CAACC,QAAP,CAAgBa,QAAhB,GAA2Bd,MAAM,CAACC,QAAP,CAAgBc,MADrD;AAEIC,YAAAA,OAAO,EAAE,IAFb;AAGIC,YAAAA,OAAO,EAAE;AAHb,WAFC;AADY,SAAf;AAN2B,OAArC;AAiBH,KAlBS,EAkBP,IAlBO,CAAV;AAmBH,GA5BD,EA4BG,EA5BH;AA8BA,SAAO,IAAP;AACH,CAhCD;;AAkCA,gBAAe;AAAA,SAAM,CACjB;AACIC,IAAAA,IAAI,EAAE,cADV;AAEIC,IAAAA,IAAI,EAAE,qCAFV;AAGIC,IAAAA,SAAS,eAAE,oBAAC,yBAAD;AAHf,GADiB,CAAN;AAAA,CAAf","sourcesContent":["import * as React from \"react\";\nimport { PbAddonRenderPlugin } from \"@webiny/app-page-builder/types\";\n\nconst InvalidateExpiredSsrCache = () => {\n    React.useEffect(() => {\n        if (!window) {\n            return;\n        }\n\n        if (window.location.hostname === \"localhost\") {\n            return;\n        }\n\n        setTimeout(() => {\n            window.fetch(window.location.origin, {\n                method: \"post\",\n                headers: {\n                    Accept: \"application/json\",\n                    \"Content-Type\": \"application/json\"\n                },\n                body: JSON.stringify({\n                    ssr: [\n                        \"invalidateSsrCacheByPath\",\n                        {\n                            path: window.location.pathname + window.location.search,\n                            expired: true,\n                            refresh: true\n                        }\n                    ]\n                })\n            });\n        }, 1000);\n    }, []);\n\n    return null;\n};\n\nexport default () => [\n    {\n        type: \"addon-render\",\n        name: \"addon-render-ssr-cache-invalidation\",\n        component: <InvalidateExpiredSsrCache />\n    } as PbAddonRenderPlugin\n];\n"],"file":"index.js"}