{"version":3,"sources":["../../../../src/site/components/Page/PageRender.tsx"],"names":["React","useMemo","Helmet","Layout","PageContent","getPlugin","getPlugins","PageRender","loading","data","error","Loader","plugins","pl","find","componentType","component","defaultErrorPagePlugin","defaultNotFoundPagePlugin","DefaultNotFoundPage","DefaultErrorPage","code","head","title","seo","description","meta","social","image","map","index","name","content","src","property","preparedProperty","replace","settings","general","layout"],"mappings":";;AAAA,OAAOA,KAAP,IAAgBC,OAAhB,QAA+B,OAA/B;AACA,SAASC,MAAT,QAAuB,cAAvB;AAEA,OAAOC,MAAP,MAAmB,UAAnB;AACA,OAAOC,WAAP,MAAwB,eAAxB;AACA,SAASC,SAAT,EAAoBC,UAApB,QAAsC,iBAAtC;;AASA,SAASC,UAAT,OAA+D;AAAA;;AAAA,MAAzCC,OAAyC,QAAzCA,OAAyC;AAAA,MAAhCC,IAAgC,QAAhCA,IAAgC;AAAA,MAA1BC,KAA0B,QAA1BA,KAA0B;AAC3D,MAAMC,MAAM,GAAGV,OAAO,CAAC,YAAM;AACzB,QAAMW,OAAO,GAAGN,UAAU,CAA8B,qBAA9B,CAA1B;AACA,QAAMO,EAAE,GAAGD,OAAO,CAACE,IAAR,CAAa,UAAAD,EAAE;AAAA,aAAIA,EAAE,CAACE,aAAH,KAAqB,QAAzB;AAAA,KAAf,CAAX;AACA,WAAOF,EAAE,GAAGA,EAAE,CAACG,SAAN,GAAkB,IAA3B;AACH,GAJqB,EAInB,EAJmB,CAAtB;;AAD2D,iBAOTf,OAAO,CAAC,YAAM;AAC5D,QAAMgB,sBAAsB,GAAGZ,SAAS,CAAsB,uBAAtB,CAAxC;AACA,QAAMa,yBAAyB,GAAGb,SAAS,CACvC,2BADuC,CAA3C;AAIA,WAAO;AACHc,MAAAA,mBAAmB,EAAED,yBAAF,aAAEA,yBAAF,uBAAEA,yBAAyB,CAAEF,SAD7C;AAEHI,MAAAA,gBAAgB,EAAEH,sBAAF,aAAEA,sBAAF,uBAAEA,sBAAsB,CAAED;AAFvC,KAAP;AAIH,GAVwD,EAUtD,EAVsD,CAPE;AAAA,MAOnDI,gBAPmD,YAOnDA,gBAPmD;AAAA,MAOjCD,mBAPiC,YAOjCA,mBAPiC;;AAmB3D,MAAIX,OAAJ,EAAa;AACT,WAAOG,MAAM,gBAAG,oBAAC,MAAD,OAAH,GAAgB,IAA7B;AACH;;AAED,MAAI,CAACF,IAAL,EAAW;AACP,QAAI,CAAAC,KAAK,SAAL,IAAAA,KAAK,WAAL,YAAAA,KAAK,CAAEW,IAAP,MAAgB,WAApB,EAAiC;AAC7B,aAAOF,mBAAmB,gBAAG,oBAAC,mBAAD;AAAqB,QAAA,KAAK,EAAET;AAA5B,QAAH,GAA2C,IAArE;AACH;;AACD,WAAOU,gBAAgB,gBAAG,oBAAC,gBAAD;AAAkB,MAAA,KAAK,EAAEV;AAAzB,MAAH,GAAwC,IAA/D;AACH;;AAED,MAAMY,IAAI,GAAG;AACTC,IAAAA,KAAK,EAAEd,IAAI,CAACc,KADH;AAETC,IAAAA,GAAG;AACCD,MAAAA,KAAK,EAAE,EADR;AAECE,MAAAA,WAAW,EAAE,EAFd;AAGCC,MAAAA,IAAI,EAAE;AAHP,OAII,KAAIjB,IAAJ,EAAU,cAAV,CAJJ,CAFM;AAQTkB,IAAAA,MAAM;AACFJ,MAAAA,KAAK,EAAE,EADL;AAEFE,MAAAA,WAAW,EAAE,EAFX;AAGFG,MAAAA,KAAK,EAAE;AAHL,OAIC,KAAInB,IAAJ,EAAU,iBAAV,CAJD;AARG,GAAb;AAgBA,sBACI;AAAK,IAAA,SAAS,EAAC;AAAf,kBACI,oBAAC,MAAD,QACKa,IAAI,CAACC,KAAL,iBAAc,mCAAQD,IAAI,CAACC,KAAb,CADnB,EAEKD,IAAI,CAACE,GAAL,CAASD,KAAT,iBAAkB;AAAM,IAAA,IAAI,EAAC,OAAX;AAAmB,IAAA,OAAO,EAAED,IAAI,CAACE,GAAL,CAASD;AAArC,IAFvB,EAGKD,IAAI,CAACE,GAAL,CAASC,WAAT,iBAAwB;AAAM,IAAA,IAAI,EAAC,aAAX;AAAyB,IAAA,OAAO,EAAEH,IAAI,CAACE,GAAL,CAASC;AAA3C,IAH7B,EAIKH,IAAI,CAACE,GAAL,CAASE,IAAT,CAAcG,GAAd,CAAkB,iBAAoBC,KAApB;AAAA,QAAGC,IAAH,SAAGA,IAAH;AAAA,QAASC,OAAT,SAASA,OAAT;AAAA,wBACf;AAAM,MAAA,GAAG,EAAEF,KAAX;AAAkB,MAAA,IAAI,EAAEC,IAAxB;AAA8B,MAAA,OAAO,EAAEC;AAAvC,MADe;AAAA,GAAlB,CAJL,EAQKV,IAAI,CAACK,MAAL,CAAYC,KAAZ,iBACG;AAAM,IAAA,QAAQ,EAAC,UAAf;AAA0B,IAAA,OAAO,EAAEN,IAAI,CAACK,MAAL,CAAYC,KAAZ,CAAkBK,GAAlB,GAAwB;AAA3D,IATR,EAWKX,IAAI,CAACK,MAAL,CAAYJ,KAAZ,iBAAqB;AAAM,IAAA,QAAQ,EAAC,UAAf;AAA0B,IAAA,OAAO,EAAED,IAAI,CAACK,MAAL,CAAYJ;AAA/C,IAX1B,EAaKD,IAAI,CAACK,MAAL,CAAYF,WAAZ,iBACG;AAAM,IAAA,QAAQ,EAAC,gBAAf;AAAgC,IAAA,OAAO,EAAEH,IAAI,CAACK,MAAL,CAAYF;AAArD,IAdR,EAgBKH,IAAI,CAACK,MAAL,CAAYD,IAAZ,CAAiBG,GAAjB,CAAqB,iBAAwBC,KAAxB,EAAkC;AAAA,QAA/BI,QAA+B,SAA/BA,QAA+B;AAAA,QAArBF,OAAqB,SAArBA,OAAqB;AACpD;AACA,QAAMG,gBAAgB,GAAG,aAAMD,QAAN,EAAiBE,OAAjB,CAAyB,QAAzB,EAAmC,KAAnC,CAAzB;AACA,wBAAO;AAAM,MAAA,GAAG,EAAEN,KAAX;AAAkB,MAAA,QAAQ,EAAEK,gBAA5B;AAA8C,MAAA,OAAO,EAAEH;AAAvD,MAAP;AACH,GAJA,CAhBL,CADJ,eAuBI,oBAAC,MAAD;AAAQ,IAAA,MAAM,EAAEvB,IAAF,aAAEA,IAAF,yCAAEA,IAAI,CAAE4B,QAAR,4EAAE,eAAgBC,OAAlB,0DAAE,sBAAyBC;AAAzC,kBACI,oBAAC,WAAD;AAAa,IAAA,IAAI,EAAE9B,IAAI,CAACuB;AAAxB,IADJ,CAvBJ,CADJ;AA6BH;;AAED,eAAezB,UAAf","sourcesContent":["import React, { useMemo } from \"react\";\nimport { Helmet } from \"react-helmet\";\nimport { get } from \"lodash\";\nimport Layout from \"./Layout\";\nimport PageContent from \"./PageContent\";\nimport { getPlugin, getPlugins } from \"@webiny/plugins\";\nimport {\n    PbPageLayoutComponentPlugin,\n    PbDefaultPagePlugin,\n    PbPageData\n} from \"@webiny/app-page-builder/types\";\n\ntype PageRenderProps = { error?: any; loading?: boolean; data?: PbPageData };\n\nfunction PageRender({ loading, data, error }: PageRenderProps) {\n    const Loader = useMemo(() => {\n        const plugins = getPlugins<PbPageLayoutComponentPlugin>(\"pb-layout-component\");\n        const pl = plugins.find(pl => pl.componentType === \"loader\");\n        return pl ? pl.component : null;\n    }, []);\n\n    const { DefaultErrorPage, DefaultNotFoundPage } = useMemo(() => {\n        const defaultErrorPagePlugin = getPlugin<PbDefaultPagePlugin>(\"pb-default-page-error\");\n        const defaultNotFoundPagePlugin = getPlugin<PbDefaultPagePlugin>(\n            \"pb-default-page-not-found\"\n        );\n\n        return {\n            DefaultNotFoundPage: defaultNotFoundPagePlugin?.component,\n            DefaultErrorPage: defaultErrorPagePlugin?.component\n        };\n    }, []);\n\n    if (loading) {\n        return Loader ? <Loader /> : null;\n    }\n\n    if (!data) {\n        if (error?.code === \"NOT_FOUND\") {\n            return DefaultNotFoundPage ? <DefaultNotFoundPage error={error} /> : null;\n        }\n        return DefaultErrorPage ? <DefaultErrorPage error={error} /> : null;\n    }\n\n    const head = {\n        title: data.title,\n        seo: {\n            title: \"\",\n            description: \"\",\n            meta: [],\n            ...get(data, \"settings.seo\")\n        },\n        social: {\n            title: \"\",\n            description: \"\",\n            image: null,\n            ...get(data, \"settings.social\")\n        }\n    };\n\n    return (\n        <div className=\"webiny-pb-page\">\n            <Helmet>\n                {head.title && <title>{head.title}</title>}\n                {head.seo.title && <meta name=\"title\" content={head.seo.title} />}\n                {head.seo.description && <meta name=\"description\" content={head.seo.description} />}\n                {head.seo.meta.map(({ name, content }, index) => (\n                    <meta key={index} name={name} content={content} />\n                ))}\n\n                {head.social.image && (\n                    <meta property=\"og:image\" content={head.social.image.src + \"?width=1596\"} />\n                )}\n                {head.social.title && <meta property=\"og:title\" content={head.social.title} />}\n\n                {head.social.description && (\n                    <meta property=\"og:description\" content={head.social.description} />\n                )}\n                {head.social.meta.map(({ property, content }, index) => {\n                    // Replace duplicate \"og:og:\" with single \"og:\".\n                    const preparedProperty = `og:${property}`.replace(\"og:og:\", \"og:\");\n                    return <meta key={index} property={preparedProperty} content={content} />;\n                })}\n            </Helmet>\n            <Layout layout={data?.settings?.general?.layout}>\n                <PageContent data={data.content} />\n            </Layout>\n        </div>\n    );\n}\n\nexport default PageRender;\n"],"file":"PageRender.js"}