{"version":3,"sources":["../../../../src/admin/views/Pages/Pages.tsx"],"names":["React","useState","useCallback","useApolloClient","useRouter","useHandler","SplitView","LeftPanel","RightPanel","FloatingActionButton","useSnackbar","CREATE_PAGE","LIST_PAGES","useDataList","CircularProgress","PagesDataList","PageDetails","CategoriesDialog","Pages","props","creatingPage","setCreatingPage","showCategoriesDialog","setCategoriesDialog","client","showSnackbar","history","dataList","query","variables","sort","savedOn","openDialog","closeDialog","createPageMutation","category","mutate","mutation","refetchQueries","awaitRefetchQueries","res","data","pageBuilder","page","push","id","message","onSelect","refresh"],"mappings":"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","sourcesContent":["import React, { useState, useCallback } from \"react\";\nimport { useApolloClient } from \"react-apollo\";\nimport { useRouter } from \"@webiny/react-router\";\nimport { useHandler } from \"@webiny/app/hooks/useHandler\";\nimport { SplitView, LeftPanel, RightPanel } from \"@webiny/app-admin/components/SplitView\";\nimport { FloatingActionButton } from \"@webiny/app-admin/components/FloatingActionButton\";\nimport { useSnackbar } from \"@webiny/app-admin/hooks/useSnackbar\";\nimport { CREATE_PAGE, LIST_PAGES } from \"@webiny/app-page-builder/admin/graphql/pages\";\nimport { useDataList } from \"@webiny/app/hooks/useDataList\";\nimport { CircularProgress } from \"@webiny/ui/Progress\";\nimport PagesDataList from \"./PagesDataList\";\nimport PageDetails from \"./PageDetails\";\nimport CategoriesDialog from \"../Categories/CategoriesDialog\";\n\nconst Pages = props => {\n    const [creatingPage, setCreatingPage] = useState(false);\n    const [showCategoriesDialog, setCategoriesDialog] = useState(false);\n    const client = useApolloClient();\n    const { showSnackbar } = useSnackbar();\n    const { history } = useRouter();\n\n    const dataList = useDataList({\n        query: LIST_PAGES,\n        variables: {\n            sort: { savedOn: -1 }\n        }\n    });\n\n    const openDialog = useCallback(() => setCategoriesDialog(true), []);\n    const closeDialog = useCallback(() => setCategoriesDialog(false), []);\n\n    const createPageMutation = useHandler(props, () => async category => {\n        try {\n            setCreatingPage(true);\n            const res = await client.mutate({\n                mutation: CREATE_PAGE,\n                variables: { category },\n                refetchQueries: [\"PbListPages\"],\n                awaitRefetchQueries: true\n            });\n            setCreatingPage(false);\n            closeDialog();\n            const { data } = res.data.pageBuilder.page;\n            history.push(`/page-builder/editor/${data.id}`);\n        } catch (e) {\n            showSnackbar(e.message);\n        }\n    });\n\n    const onSelect = useCallback(category => {\n        createPageMutation(category.id);\n    }, []);\n\n    return (\n        <React.Fragment>\n            <CategoriesDialog open={showCategoriesDialog} onClose={closeDialog} onSelect={onSelect}>\n                {creatingPage && <CircularProgress label={\"Creating page...\"} />}\n            </CategoriesDialog>\n            <SplitView>\n                <LeftPanel span={4}>\n                    <PagesDataList dataList={dataList} />\n                </LeftPanel>\n                <RightPanel span={8}>\n                    <PageDetails refreshPages={dataList.refresh} />\n                </RightPanel>\n            </SplitView>\n            <FloatingActionButton data-testid=\"new-record-button\" onClick={openDialog} />\n        </React.Fragment>\n    );\n};\n\nexport default Pages;\n"],"file":"Pages.js"}