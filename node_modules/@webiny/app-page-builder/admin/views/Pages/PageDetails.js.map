{"version":3,"sources":["../../../../src/admin/views/Pages/PageDetails.tsx"],"names":["React","Query","useRouter","styled","Elevation","renderPlugins","GET_PAGE","PageDetailsProvider","PageDetailsConsumer","ElementAnimation","useSnackbar","EmptySelect","width","height","display","alignItems","justifyContent","color","maxWidth","padding","textAlign","borderRadius","backgroundColor","DetailsContainer","overflow","position","nav","EmptyPageDetails","PageDetails","refreshPages","history","location","showSnackbar","query","URLSearchParams","search","pageId","get","id","data","error","delete","push","toString","loading","details","page","refresh","pageDetails"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { Query } from \"react-apollo\";\nimport { useRouter } from \"@webiny/react-router\";\nimport styled from \"@emotion/styled\";\nimport { Elevation } from \"@webiny/ui/Elevation\";\nimport { renderPlugins } from \"@webiny/app/plugins\";\nimport { GET_PAGE } from \"@webiny/app-page-builder/admin/graphql/pages\";\nimport { PageDetailsProvider, PageDetailsConsumer } from \"../../contexts/PageDetails\";\nimport { ElementAnimation } from \"@webiny/app-page-builder/render/components\";\nimport { useSnackbar } from \"@webiny/app-admin/hooks/useSnackbar\";\nimport { get } from \"lodash\";\n\ndeclare global {\n    // eslint-disable-next-line\n    namespace JSX {\n        interface IntrinsicElements {\n            \"test-id\": {\n                children?: React.ReactNode;\n            };\n        }\n    }\n}\n\nconst EmptySelect = styled(\"div\")({\n    width: \"100%\",\n    height: \"100%\",\n    display: \"flex\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    color: \"var(--mdc-theme-on-surface)\",\n    \".select-page\": {\n        maxWidth: 400,\n        padding: \"50px 100px\",\n        textAlign: \"center\",\n        display: \"block\",\n        borderRadius: 2,\n        backgroundColor: \"var(--mdc-theme-surface)\"\n    }\n});\n\nconst DetailsContainer = styled(\"div\")({\n    height: \"calc(100% - 10px)\",\n    overflow: \"hidden\",\n    position: \"relative\",\n    nav: {\n        backgroundColor: \"var(--mdc-theme-surface)\"\n    }\n});\n\nconst EmptyPageDetails = () => {\n    return (\n        <EmptySelect>\n            <Elevation z={2} className={\"select-page\"}>\n                Select a page on the left side, or click the green button to create a new one.\n            </Elevation>\n        </EmptySelect>\n    );\n};\n\nconst PageDetails = ({ refreshPages }) => {\n    const { history, location } = useRouter();\n    const { showSnackbar } = useSnackbar();\n\n    const query = new URLSearchParams(location.search);\n    const pageId = query.get(\"id\");\n\n    if (!pageId) {\n        return <EmptyPageDetails />;\n    }\n\n    return (\n        <Query\n            query={GET_PAGE()}\n            variables={{ id: pageId }}\n            onCompleted={data => {\n                const error = get(data, \"pageBuilder.page.error.message\");\n                if (error) {\n                    query.delete(\"id\");\n                    history.push({ search: query.toString() });\n                    showSnackbar(error);\n                }\n            }}\n        >\n            {({ data, loading }) => {\n                const details = { page: get(data, \"pageBuilder.page.data\") || {}, loading };\n                return (\n                    <ElementAnimation>\n                        {({ refresh }) => (\n                            <DetailsContainer onScroll={refresh}>\n                                <PageDetailsProvider value={details}>\n                                    <PageDetailsConsumer>\n                                        {pageDetails => (\n                                            <React.Fragment>\n                                                <test-id data-testid=\"pb-page-details\">\n                                                    {renderPlugins(\"pb-page-details\", {\n                                                        refreshPages,\n                                                        pageDetails,\n                                                        loading\n                                                    })}\n                                                </test-id>\n                                            </React.Fragment>\n                                        )}\n                                    </PageDetailsConsumer>\n                                </PageDetailsProvider>\n                            </DetailsContainer>\n                        )}\n                    </ElementAnimation>\n                );\n            }}\n        </Query>\n    );\n};\n\nexport default PageDetails;\n"],"file":"PageDetails.js"}