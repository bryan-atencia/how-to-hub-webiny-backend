{"version":3,"sources":["../../../../../../src/admin/plugins/settings/components/generalSettings/GeneralSettings.tsx"],"names":["React","Form","Grid","Cell","Input","ButtonPrimary","SingleImageUpload","Query","Mutation","useSnackbar","graphql","CircularProgress","validation","SimpleForm","SimpleFormFooter","SimpleFormContent","SimpleFormHeader","DOMAIN_QUERY","GeneralSettings","showSnackbar","query","data","queryInProgress","loading","settings","mutation","cache","dataFromCache","readQuery","updatedSettings","writeQuery","update","mutationInProgress","variables","Bind","form","create","submit"],"mappings":"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","sourcesContent":["import * as React from \"react\";\nimport { Form } from \"@webiny/form\";\nimport { Grid, Cell } from \"@webiny/ui/Grid\";\nimport { Input } from \"@webiny/ui/Input\";\nimport { ButtonPrimary } from \"@webiny/ui/Button\";\nimport SingleImageUpload from \"@webiny/app-admin/components/SingleImageUpload\";\n\nimport { Query, Mutation } from \"react-apollo\";\nimport { useSnackbar } from \"@webiny/app-admin/hooks/useSnackbar\";\nimport graphql from \"./graphql\";\nimport { CircularProgress } from \"@webiny/ui/Progress\";\nimport { get, set } from \"lodash\";\nimport { validation } from \"@webiny/validation\";\n\nimport {\n    SimpleForm,\n    SimpleFormFooter,\n    SimpleFormContent,\n    SimpleFormHeader\n} from \"@webiny/app-admin/components/SimpleForm\";\nimport { DOMAIN_QUERY } from \"@webiny/app-page-builder/admin/hooks/usePageBuilderSettings/usePageBuilderSettings\";\n\nconst GeneralSettings = () => {\n    const { showSnackbar } = useSnackbar();\n    return (\n        <Query query={graphql.query}>\n            {({ data, loading: queryInProgress }) => {\n                const settings = get(data, \"pageBuilder.getSettings.data\") || {};\n                return (\n                    <Mutation\n                        mutation={graphql.mutation}\n                        update={(cache, { data }) => {\n                            const dataFromCache = cache.readQuery({ query: DOMAIN_QUERY });\n                            const updatedSettings = get(data, \"pageBuilder.updateSettings.data\");\n\n                            if (updatedSettings) {\n                                cache.writeQuery({\n                                     query: DOMAIN_QUERY,\n                                     data: set(dataFromCache, \"pageBuilder.getSettings.data\", updatedSettings)\n                                });\n                            }\n                        }}\n                    >\n                        {(update, {loading: mutationInProgress}) => (\n                            <Form\n                                data={settings}\n                                onSubmit={async data => {\n                                    await update({\n                                        variables: {\n                                            data\n                                        }\n                                    });\n                                    showSnackbar(\"Settings updated successfully.\");\n                                }}\n                            >\n                                {({ Bind, form }) => (\n                                    <SimpleForm>\n                                        {(queryInProgress || mutationInProgress) && (\n                                            <CircularProgress />\n                                        )}\n                                        <SimpleFormHeader title={`General Settings`} />\n                                        <SimpleFormContent>\n                                            <Grid>\n                                                <Cell span={6}>\n                                                    <Grid>\n                                                        <Cell span={12}>\n                                                            <Bind\n                                                                name={\"name\"}\n                                                                validators={validation.create(\n                                                                    \"required\"\n                                                                )}\n                                                            >\n                                                                <Input label=\"Website name\" />\n                                                            </Bind>\n                                                        </Cell>\n                                                        <Cell span={12}>\n                                                            <Bind name={\"domain\"}>\n                                                                <Input\n                                                                    label=\"Domain\"\n                                                                    description={\n                                                                        \"eg. https://www.mysite.com\"\n                                                                    }\n                                                                />\n                                                            </Bind>\n                                                        </Cell>\n                                                        <Cell span={6}>\n                                                            <Bind name={\"favicon\"}>\n                                                                <SingleImageUpload\n                                                                    label=\"Favicon\"\n                                                                    accept={[\n                                                                        \"image/png\",\n                                                                        \"image/x-icon\",\n                                                                        \"image/vnd.microsoft.icon\"\n                                                                    ]}\n                                                                    description={\n                                                                        <span>\n                                                                            Supported file types:{\" \"}\n                                                                            <strong>.png</strong>{\" \"}\n                                                                            and{\" \"}\n                                                                            <strong>.ico</strong> .\n                                                                        </span>\n                                                                    }\n                                                                />\n                                                            </Bind>\n                                                        </Cell>\n                                                        <Cell span={6}>\n                                                            <Bind name={\"logo\"}>\n                                                                <SingleImageUpload label=\"Logo\" />\n                                                            </Bind>\n                                                        </Cell>\n                                                    </Grid>\n                                                </Cell>\n\n                                                <Cell span={6}>\n                                                    <Grid>\n                                                        <Cell span={12}>\n                                                            <Bind\n                                                                name={\"social.facebook\"}\n                                                                validators={validation.create(\n                                                                    \"url\"\n                                                                )}\n                                                            >\n                                                                <Input label=\"Facebook\" />\n                                                            </Bind>\n                                                        </Cell>\n                                                        <Cell span={12}>\n                                                            <Bind\n                                                                name={\"social.twitter\"}\n                                                                validators={validation.create(\n                                                                    \"url\"\n                                                                )}\n                                                            >\n                                                                <Input label=\"Twitter\" />\n                                                            </Bind>\n                                                        </Cell>\n                                                        <Cell span={12}>\n                                                            <Bind\n                                                                name={\"social.instagram\"}\n                                                                validators={validation.create(\n                                                                    \"url\"\n                                                                )}\n                                                            >\n                                                                <Input label=\"Instagram\" />\n                                                            </Bind>\n                                                        </Cell>\n                                                    </Grid>\n                                                </Cell>\n                                            </Grid>\n                                        </SimpleFormContent>\n                                        <SimpleFormFooter>\n                                            <ButtonPrimary onClick={form.submit}>\n                                                Save\n                                            </ButtonPrimary>\n                                        </SimpleFormFooter>\n                                    </SimpleForm>\n                                )}\n                            </Form>\n                        )}\n                    </Mutation>\n                );\n            }}\n        </Query>\n    );\n};\n\nexport default GeneralSettings;\n"],"file":"GeneralSettings.js"}