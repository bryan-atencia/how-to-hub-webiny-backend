{"version":3,"sources":["../../../../../src/admin/plugins/pageDetails/pageRevisions/Revision.tsx"],"names":["React","css","TimeAgo","ListItem","ListItemText","ListItemTextPrimary","ListItemTextSecondary","ListItemGraphic","ListItemMeta","IconButton","Icon","MenuItem","Menu","MenuDivider","ConfirmationDialog","Tooltip","useRevisionHandlers","usePageBuilderSettings","primaryColor","color","revisionsMenu","width","right","left","getIcon","rev","locked","published","icon","text","Div","children","Revision","tooltipText","getPagePreviewUrl","deleteRevision","createRevision","publishRevision","editRevision","showConfirmation","title","savedOn","version","window","open","id","parent"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { css } from \"emotion\";\nimport TimeAgo from \"timeago-react\";\nimport {\n    ListItem,\n    ListItemText,\n    ListItemTextPrimary,\n    ListItemTextSecondary,\n    ListItemGraphic,\n    ListItemMeta\n} from \"@webiny/ui/List\";\nimport { IconButton } from \"@webiny/ui/Button\";\nimport { Icon } from \"@webiny/ui/Icon\";\nimport { MenuItem, Menu, MenuDivider } from \"@webiny/ui/Menu\";\nimport { ConfirmationDialog } from \"@webiny/ui/ConfirmationDialog\";\nimport { Tooltip } from \"@webiny/ui/Tooltip\";\nimport { ReactComponent as MoreVerticalIcon } from \"@webiny/app-page-builder/admin/assets/more_vert.svg\";\nimport { ReactComponent as LockIcon } from \"@webiny/app-page-builder/admin/assets/lock.svg\";\nimport { ReactComponent as BeenHereIcon } from \"@webiny/app-page-builder/admin/assets/beenhere.svg\";\nimport { ReactComponent as GestureIcon } from \"@webiny/app-page-builder/admin/assets/gesture.svg\";\nimport { useRevisionHandlers } from \"./useRevisionHandlers\";\nimport { usePageBuilderSettings } from \"@webiny/app-page-builder/admin/hooks/usePageBuilderSettings\";\nimport { ReactComponent as AddIcon } from \"@webiny/app-page-builder/admin/assets/add.svg\";\nimport { ReactComponent as EditIcon } from \"@webiny/app-page-builder/admin/assets/edit.svg\";\nimport { ReactComponent as PublishIcon } from \"@webiny/app-page-builder/admin/assets/round-publish-24px.svg\";\nimport { ReactComponent as DeleteIcon } from \"@webiny/app-page-builder/admin/assets/delete.svg\";\nimport { ReactComponent as PreviewIcon } from \"@webiny/app-page-builder/admin/assets/visibility.svg\";\nimport { PbPageRevision } from \"@webiny/app-page-builder/types\";\n\ntype RevisionProps = {\n    rev: PbPageRevision;\n};\n\nconst primaryColor = css({ color: \"var(--mdc-theme-primary)\" });\n\nconst revisionsMenu = css({\n    width: 250,\n    right: -105,\n    left: \"auto !important\"\n});\n\nconst getIcon = (rev: PbPageRevision) => {\n    switch (true) {\n        case rev.locked && !rev.published:\n            return {\n                icon: <Icon icon={<LockIcon />} />,\n                text: \"This revision is locked (it has already been published)\"\n            };\n        case rev.published:\n            return {\n                icon: <Icon icon={<BeenHereIcon />} className={primaryColor} />,\n                text: \"This revision is currently published!\"\n            };\n        default:\n            return {\n                icon: <Icon icon={<GestureIcon />} />,\n                text: \"This is a draft\"\n            };\n    }\n};\n\nconst Div = ({ children }) => {\n    return <div>{children}</div>;\n};\n\nconst Revision = ({ rev }: RevisionProps) => {\n    const { icon, text: tooltipText } = getIcon(rev);\n    const { getPagePreviewUrl } = usePageBuilderSettings();\n    const { deleteRevision, createRevision, publishRevision, editRevision } = useRevisionHandlers({\n        rev\n    });\n\n    return (\n        <ConfirmationDialog\n            title=\"Confirmation required!\"\n            message={<span>Are you sure you want to delete this revision?</span>}\n        >\n            {({ showConfirmation }) => (\n                <ListItem>\n                    <ListItemGraphic>\n                        <Tooltip content={tooltipText} placement={\"bottom\"}>\n                            {icon}\n                        </Tooltip>\n                    </ListItemGraphic>\n                    <ListItemText>\n                        <ListItemTextPrimary>{rev.title}</ListItemTextPrimary>\n                        <ListItemTextSecondary>\n                            Last modified <TimeAgo datetime={rev.savedOn} /> (#\n                            {rev.version})\n                        </ListItemTextSecondary>\n                    </ListItemText>\n                    <ListItemMeta>\n                        <Menu\n                            handle={<IconButton icon={<MoreVerticalIcon />} />}\n                            className={revisionsMenu}\n                            /*openSide={\"left\"} TODO: @adrian */\n                        >\n                            <MenuItem onClick={createRevision}>\n                                <ListItemGraphic>\n                                    <Icon icon={<AddIcon />} />\n                                </ListItemGraphic>\n                                New from current\n                            </MenuItem>\n                            {!rev.locked && (\n                                <MenuItem onClick={editRevision}>\n                                    <ListItemGraphic>\n                                        <Icon icon={<EditIcon />} />\n                                    </ListItemGraphic>\n                                    Edit\n                                </MenuItem>\n                            )}\n\n                            {!rev.published && (\n                                <MenuItem onClick={() => publishRevision(rev)}>\n                                    <ListItemGraphic>\n                                        <Icon icon={<PublishIcon />} />\n                                    </ListItemGraphic>\n                                    Publish\n                                </MenuItem>\n                            )}\n\n                            <MenuItem onClick={() => window.open(getPagePreviewUrl(rev), \"_blank\")}>\n                                <ListItemGraphic>\n                                    <Icon icon={<PreviewIcon />} />\n                                </ListItemGraphic>\n                                Preview\n                            </MenuItem>\n\n                            {!rev.locked && rev.id !== rev.parent && (\n                                <Div>\n                                    <MenuDivider />\n                                    <MenuItem onClick={() => showConfirmation(deleteRevision)}>\n                                        <ListItemGraphic>\n                                            <Icon icon={<DeleteIcon />} />\n                                        </ListItemGraphic>\n                                        Delete\n                                    </MenuItem>\n                                </Div>\n                            )}\n                        </Menu>\n                    </ListItemMeta>\n                </ListItem>\n            )}\n        </ConfirmationDialog>\n    );\n};\n\nexport default Revision;\n"],"file":"Revision.js"}