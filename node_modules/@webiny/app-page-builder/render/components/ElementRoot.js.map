{"version":3,"sources":["../../../src/render/components/ElementRoot.tsx"],"names":["React","get","getPlugins","Node","combineClassNames","styles","filter","s","join","ElementRoot","props","stylePlugins","attributePlugins","element","data","style","children","className","shallowElement","id","type","finalStyle","reduce","pl","renderStyle","attributes","renderAttributes","classNames","getAllClasses","extraClasses","split","v","elementStyle","elementAttributes","customClasses","Component"],"mappings":"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","sourcesContent":["import React, { CSSProperties, ReactElement } from \"react\";\nimport { get } from \"dot-prop-immutable\";\nimport { isEqual } from \"lodash\";\nimport { getPlugins } from \"@webiny/plugins\";\nimport {\n    PbRenderElementStylePlugin,\n    PbRenderElementAttributesPlugin,\n    PbElement\n} from \"@webiny/app-page-builder/types\";\n\nconst Node = \"div\";\n\nconst combineClassNames = (...styles) => {\n    return styles.filter(s => s !== \"\" && s !== \"css-0\").join(\" \");\n};\n\nexport type ElementRootChildrenFunction = (params: {\n    getAllClasses(...classes: string[]): string;\n    combineClassNames(...classes: string[]): string;\n    elementStyle: CSSProperties;\n    elementAttributes: { [key: string]: string };\n    customClasses: string[];\n}) => ReactElement;\n\nexport type ElementRootProps = {\n    element: PbElement;\n    style?: CSSProperties;\n    className?: string;\n    children?: ReactElement | ReactElement[] | ElementRootChildrenFunction;\n};\n\nclass ElementRoot extends React.Component<ElementRootProps> {\n    stylePlugins: Array<PbRenderElementStylePlugin>;\n    attributePlugins: Array<PbRenderElementAttributesPlugin>;\n\n    constructor(props) {\n        super(props);\n\n        this.stylePlugins = getPlugins<PbRenderElementStylePlugin>(\"pb-render-page-element-style\");\n        this.attributePlugins = getPlugins<PbRenderElementAttributesPlugin>(\n            \"pb-render-page-element-attributes\"\n        );\n    }\n\n    shouldComponentUpdate(props: ElementRootProps) {\n        return !isEqual(props.element.data, this.props.element.data);\n    }\n\n    render() {\n        const { element, style = {}, children, className = null } = this.props;\n\n        const shallowElement = { id: element.id, type: element.type, data: element.data };\n\n        const finalStyle = this.stylePlugins.reduce((style, pl) => {\n            return pl.renderStyle({ element: shallowElement, style });\n        }, style);\n\n        const attributes = this.attributePlugins.reduce((attributes, pl) => {\n            return pl.renderAttributes({ element: shallowElement, attributes });\n        }, {});\n\n        const classNames = get(element, \"data.settings.className\", \"\");\n\n        const getAllClasses = (...extraClasses) => {\n            return [className, ...extraClasses, ...classNames.split(\" \")]\n                .filter(v => v && v !== \"css-0\")\n                .join(\" \");\n        };\n\n        if (typeof children === \"function\") {\n            return children({\n                getAllClasses,\n                combineClassNames,\n                elementStyle: finalStyle,\n                elementAttributes: attributes,\n                customClasses: classNames.split(\" \")\n            });\n        }\n\n        return (\n            <Node className={getAllClasses()} style={finalStyle} {...attributes}>\n                {children}\n            </Node>\n        );\n    }\n}\n\nexport { ElementRoot };\n"],"file":"ElementRoot.js"}