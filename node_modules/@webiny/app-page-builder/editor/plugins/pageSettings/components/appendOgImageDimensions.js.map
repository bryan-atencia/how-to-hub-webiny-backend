{"version":3,"sources":["../../../../../src/editor/plugins/pageSettings/components/appendOgImageDimensions.ts"],"names":["OG_IMAGE_DIMENSIONS_PROPERTIES","form","value","src","startsWith","setState","state","next","data","settings","social","meta","filter","item","property","includes","Promise","resolve","reject","image","window","Image","onload","onerror","Array","isArray","push","content","String","width","height"],"mappings":";;;AAAA,IAAMA,8BAA8B,GAAG,CAAC,aAAD,EAAgB,cAAhB,CAAvC;AAEA;AAAA,uEAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAASC,YAAAA,IAAT,QAASA,IAAT,EAAeC,KAAf,QAAeA,KAAf;;AAAA,kBACP,CAACA,KAAD,IAAUA,KAAK,CAACC,GAAN,CAAUC,UAAV,CAAqB,OAArB,CADH;AAAA;AAAA;AAAA;;AAEPH,YAAAA,IAAI,CAACI,QAAL,CAAc,UAAAC,KAAK,EAAI;AACnB,kBAAMC,IAAI,qBAAQD,KAAR,CAAV,CADmB,CAEnB;;;AACAC,cAAAA,IAAI,CAACC,IAAL,CAAUC,QAAV,CAAmBC,MAAnB,CAA0BC,IAA1B,GAAiCJ,IAAI,CAACC,IAAL,CAAUC,QAAV,CAAmBC,MAAnB,CAA0BC,IAA1B,CAA+BC,MAA/B,CAAsC,UAAAC,IAAI,EAAI;AAC3E,uBAAOA,IAAI,CAACC,QAAL,IAAiB,CAACd,8BAA8B,CAACe,QAA/B,CAAwCF,IAAI,CAACC,QAA7C,CAAzB;AACH,eAFgC,CAAjC;AAGA,qBAAOP,IAAP;AACH,aAPD;AAFO;;AAAA;AAAA;AAAA,mBAac,IAAIS,OAAJ,CAAY,UAASC,OAAT,EAAkBC,MAAlB,EAA0B;AAC3D,kBAAMC,KAAK,GAAG,IAAIC,MAAM,CAACC,KAAX,EAAd;;AACAF,cAAAA,KAAK,CAACG,MAAN,GAAe,YAAW;AACtBL,gBAAAA,OAAO,CAACE,KAAD,CAAP;AACH,eAFD;;AAGAA,cAAAA,KAAK,CAACI,OAAN,GAAgBL,MAAhB;AACAC,cAAAA,KAAK,CAAChB,GAAN,GAAYD,KAAK,CAACC,GAAlB;AACH,aAPwB,CAbd;;AAAA;AAaLgB,YAAAA,KAbK;AAsBXlB,YAAAA,IAAI,CAACI,QAAL,CAAc,UAAAC,KAAK,EAAI;AACnB,kBAAMC,IAAI,qBAAQD,KAAR,CAAV,CADmB,CAEnB;;;AACA,kBAAIkB,KAAK,CAACC,OAAN,CAAclB,IAAI,CAACC,IAAL,CAAUC,QAAV,CAAmBC,MAAnB,CAA0BC,IAAxC,CAAJ,EAAmD;AAC/CJ,gBAAAA,IAAI,CAACC,IAAL,CAAUC,QAAV,CAAmBC,MAAnB,CAA0BC,IAA1B,GAAiCJ,IAAI,CAACC,IAAL,CAAUC,QAAV,CAAmBC,MAAnB,CAA0BC,IAA1B,CAA+BC,MAA/B,CAAsC,UAAAC,IAAI,EAAI;AAC3E,yBAAO,CAACb,8BAA8B,CAACe,QAA/B,CAAwCF,IAAI,CAACC,QAA7C,CAAR;AACH,iBAFgC,CAAjC;AAGH,eAJD,MAIO;AACHP,gBAAAA,IAAI,CAACC,IAAL,CAAUC,QAAV,CAAmBC,MAAnB,CAA0BC,IAA1B,GAAiC,EAAjC;AACH;;AAEDJ,cAAAA,IAAI,CAACC,IAAL,CAAUC,QAAV,CAAmBC,MAAnB,CAA0BC,IAA1B,CAA+Be,IAA/B,CACI;AACIZ,gBAAAA,QAAQ,EAAE,gBADd;AAEIa,gBAAAA,OAAO,EAAEC,MAAM,CAACT,KAAK,CAACU,KAAP;AAFnB,eADJ,EAKI;AACIf,gBAAAA,QAAQ,EAAE,iBADd;AAEIa,gBAAAA,OAAO,EAAEC,MAAM,CAACT,KAAK,CAACW,MAAP;AAFnB,eALJ;AAWA,qBAAOvB,IAAP;AACH,aAvBD;;AAtBW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAf;;AAAA;AAAA;AAAA;AAAA","sourcesContent":["const OG_IMAGE_DIMENSIONS_PROPERTIES = [\"image:width\", \"image:height\"];\n\nexport default async ({ form, value }) => {\n    if (!value || value.src.startsWith(\"data:\")) {\n        form.setState(state => {\n            const next = { ...state };\n            // Remove previously set og:image:width / og:image:height.\n            next.data.settings.social.meta = next.data.settings.social.meta.filter(item => {\n                return item.property && !OG_IMAGE_DIMENSIONS_PROPERTIES.includes(item.property);\n            });\n            return next;\n        });\n        return;\n    }\n\n    const image: any = await new Promise(function(resolve, reject) {\n        const image = new window.Image();\n        image.onload = function() {\n            resolve(image);\n        };\n        image.onerror = reject;\n        image.src = value.src;\n    });\n\n    form.setState(state => {\n        const next = { ...state };\n        // Remove previously set og:image:width / og:image:height.\n        if (Array.isArray(next.data.settings.social.meta)) {\n            next.data.settings.social.meta = next.data.settings.social.meta.filter(item => {\n                return !OG_IMAGE_DIMENSIONS_PROPERTIES.includes(item.property);\n            });\n        } else {\n            next.data.settings.social.meta = [];\n        }\n\n        next.data.settings.social.meta.push(\n            {\n                property: \"og:image:width\",\n                content: String(image.width)\n            },\n            {\n                property: \"og:image:height\",\n                content: String(image.height)\n            }\n        );\n\n        return next;\n    });\n};\n"],"file":"appendOgImageDimensions.js"}