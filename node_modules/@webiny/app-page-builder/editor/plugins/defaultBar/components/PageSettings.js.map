{"version":3,"sources":["../../../../../src/editor/plugins/defaultBar/components/PageSettings.tsx"],"names":["React","useState","useCallback","useEffect","connect","getPlugins","deactivatePlugin","updateRevision","getPage","useKeyHandler","useSnackbar","OverlayLayout","SplitView","LeftPanel","RightPanel","Typography","Form","Icon","ButtonPrimary","List","ListItem","ListItemGraphic","SimpleForm","SimpleFormFooter","SimpleFormContent","SimpleFormHeader","Title","listItem","ListItemTitle","listStyle","TitleContent","PageSettings","props","plugins","active","setActive","activePlugin","find","pl","name","PageSettingsContent","page","showSnackbar","removeKeyHandler","addKeyHandler","savePage","onFinish","e","preventDefault","map","icon","title","description","Bind","submit","form","data","render","state"],"mappings":"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","sourcesContent":["import React, { useState, useCallback, useEffect } from \"react\";\nimport { connect } from \"@webiny/app-page-builder/editor/redux\";\nimport { omit } from \"lodash\";\nimport { getPlugins } from \"@webiny/plugins\";\nimport { deactivatePlugin, updateRevision } from \"@webiny/app-page-builder/editor/actions\";\nimport { getPage } from \"@webiny/app-page-builder/editor/selectors\";\nimport { useKeyHandler } from \"@webiny/app-page-builder/editor/hooks/useKeyHandler\";\nimport { useSnackbar } from \"@webiny/app-admin/hooks/useSnackbar\";\nimport { OverlayLayout } from \"@webiny/app-admin/components/OverlayLayout\";\nimport { SplitView, LeftPanel, RightPanel } from \"@webiny/app-admin/components/SplitView\";\nimport { Typography } from \"@webiny/ui/Typography\";\nimport { Form } from \"@webiny/form\";\nimport { Icon } from \"@webiny/ui/Icon\";\nimport { ButtonPrimary } from \"@webiny/ui/Button\";\nimport { List, ListItem, ListItemGraphic } from \"@webiny/ui/List\";\nimport {\n    SimpleForm,\n    SimpleFormFooter,\n    SimpleFormContent,\n    SimpleFormHeader\n} from \"@webiny/app-admin/components/SimpleForm\";\nimport { Title, listItem, ListItemTitle, listStyle, TitleContent } from \"./PageSettingsStyled\";\nimport {\n    PbEditorPageSettingsPlugin\n} from \"@webiny/app-page-builder/types\";\n\nconst PageSettings = props => {\n    const plugins = getPlugins<PbEditorPageSettingsPlugin>(\"pb-editor-page-settings\");\n    const [active, setActive] = useState(\"pb-editor-page-settings-general\");\n    const activePlugin = plugins.find(pl => pl.name === active);\n    if (!activePlugin) {\n        return null;\n    }\n\n    return (\n        <PageSettingsContent\n            {...props}\n            setActive={setActive}\n            plugins={plugins}\n            activePlugin={activePlugin}\n        />\n    );\n};\n\nconst PageSettingsContent = ({\n    page,\n    plugins,\n    setActive,\n    activePlugin,\n    deactivatePlugin,\n    updateRevision\n}) => {\n    const { showSnackbar } = useSnackbar();\n    const { removeKeyHandler, addKeyHandler } = useKeyHandler();\n\n    const savePage = useCallback(\n        page => {\n            updateRevision(page, {\n                onFinish: () => showSnackbar(\"Settings saved\")\n            });\n        },\n        [page]\n    );\n\n    useEffect(() => {\n        addKeyHandler(\"escape\", e => {\n            e.preventDefault();\n            deactivatePlugin({ name: \"pb-editor-page-settings-bar\" });\n        });\n\n        return () => removeKeyHandler(\"escape\");\n    });\n\n    return (\n        <OverlayLayout\n            barMiddle={Title}\n            onExited={() => deactivatePlugin({ name: \"pb-editor-page-settings-bar\" })}\n        >\n            <SplitView>\n                <LeftPanel span={5}>\n                    <List twoLine className={listStyle}>\n                        {plugins.map(pl => (\n                            <ListItem\n                                key={pl.name}\n                                className={listItem}\n                                onClick={() => setActive(pl.name)}\n                            >\n                                <ListItemGraphic>\n                                    <Icon icon={pl.icon} />\n                                </ListItemGraphic>\n                                <TitleContent>\n                                    <ListItemTitle>{pl.title}</ListItemTitle>\n                                    <Typography use={\"subtitle2\"}>{pl.description}</Typography>\n                                </TitleContent>\n                            </ListItem>\n                        ))}\n                    </List>\n                </LeftPanel>\n                <RightPanel span={7}>\n                    <Form data={page} onSubmit={savePage}>\n                        {({ Bind, submit, form, data }) => (\n                            <SimpleForm>\n                                <SimpleFormHeader title={activePlugin.title} />\n                                <SimpleFormContent>\n                                    {activePlugin\n                                        ? activePlugin.render({ Bind, form, data })\n                                        : null}\n                                </SimpleFormContent>\n                                <SimpleFormFooter>\n                                    <ButtonPrimary onClick={submit}>Save settings</ButtonPrimary>\n                                </SimpleFormFooter>\n                            </SimpleForm>\n                        )}\n                    </Form>\n                </RightPanel>\n            </SplitView>\n        </OverlayLayout>\n    );\n};\n\nexport default connect<any, any, any>(\n    state => ({ page: omit(getPage(state), [\"content\"]) }),\n    { deactivatePlugin, updateRevision }\n)(PageSettings);\n"],"file":"PageSettings.js"}