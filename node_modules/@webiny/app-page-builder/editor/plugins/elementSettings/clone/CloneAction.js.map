{"version":3,"sources":["../../../../../src/editor/plugins/elementSettings/clone/CloneAction.ts"],"names":["React","useHandler","connect","getPlugins","set","redux","updateElement","getActiveElement","cloneElement","getElementWithChildren","getParentElementWithChildren","CloneAction","props","element","children","onClick","state","store","getState","id","parent","position","elements","findIndex","el","newElement","slice","length","plugin","find","pl","elementType","type"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,UAAT,QAA2B,8BAA3B;AACA,SAASC,OAAT,QAAwB,uCAAxB;AACA,SAASC,UAAT,QAA2B,iBAA3B;AACA,SAASC,GAAT,QAAoB,oBAApB;AACA,SAASC,KAAT,QAAsB,uCAAtB;AACA,SAASC,aAAT,QAA8B,yCAA9B;AACA,SAASC,gBAAT,QAAiC,2CAAjC;AACA,SAASC,YAAT,QAA6B,uCAA7B;AACA,SACIC,sBADJ,EAEIC,4BAFJ,QAGO,2CAHP;;AAMA,IAAMC,WAAW,GAAG,SAAdA,WAAc,CAAAC,KAAK,EAAI;AAAA,MACjBC,OADiB,GACKD,KADL,CACjBC,OADiB;AAAA,MACRC,QADQ,GACKF,KADL,CACRE,QADQ;AAGzB,MAAMC,OAAO,GAAGd,UAAU,CAACW,KAAD,EAAQ;AAAA,QAAGC,OAAH,QAAGA,OAAH;AAAA,QAAYP,aAAZ,QAAYA,aAAZ;AAAA,WAAgC,YAAM;AACpE,UAAMU,KAAK,GAAGX,KAAK,CAACY,KAAN,CAAYC,QAAZ,EAAd;AACAL,MAAAA,OAAO,GAAGJ,sBAAsB,CAACO,KAAD,EAAQH,OAAO,CAACM,EAAhB,CAAhC;AACA,UAAMC,MAAM,GAAGV,4BAA4B,CAACM,KAAD,EAAQH,OAAO,CAACM,EAAhB,CAA3C;AACA,UAAME,QAAQ,GAAGD,MAAM,CAACE,QAAP,CAAgBC,SAAhB,CAA0B,UAAAC,EAAE;AAAA,eAAIA,EAAE,CAACL,EAAH,KAAUN,OAAO,CAACM,EAAtB;AAAA,OAA5B,IAAwD,CAAzE;AAEA,UAAMM,UAAU,GAAGrB,GAAG,CAACgB,MAAD,EAAS,UAAT,+BACfA,MAAM,CAACE,QAAP,CAAgBI,KAAhB,CAAsB,CAAtB,EAAyBL,QAAzB,CADe,IAElBb,YAAY,CAACK,OAAD,CAFM,sBAGdQ,QAAQ,GAAGD,MAAM,CAACE,QAAP,CAAgBK,MAA3B,GAAoCP,MAAM,CAACE,QAAP,CAAgBI,KAAhB,CAAsBL,QAAtB,CAApC,GAAsE,EAHxD,GAAtB;AAKAf,MAAAA,aAAa,CAAC;AAAEO,QAAAA,OAAO,EAAEY;AAAX,OAAD,CAAb;AACH,KAZiC;AAAA,GAAR,CAA1B;AAcA,MAAMG,MAAM,GAAGzB,UAAU,CAA4B,wBAA5B,CAAV,CAAgE0B,IAAhE,CACX,UAAAC,EAAE;AAAA,WAAIA,EAAE,CAACC,WAAH,KAAmBlB,OAAO,CAACmB,IAA/B;AAAA,GADS,CAAf;;AAIA,MAAI,CAACJ,MAAL,EAAa;AACT,WAAO,IAAP;AACH;;AAED,sBAAO5B,KAAK,CAACQ,YAAN,CAAmBM,QAAnB,EAA6B;AAAEC,IAAAA,OAAO,EAAPA;AAAF,GAA7B,CAAP;AACH,CA1BD;;AA4BA,eAAeb,OAAO,CAAgB,UAAAc,KAAK;AAAA,SAAK;AAAEH,IAAAA,OAAO,EAAEN,gBAAgB,CAACS,KAAD;AAA3B,GAAL;AAAA,CAArB,EAAiE;AACnFV,EAAAA,aAAa,EAAbA;AADmF,CAAjE,CAAP,CAEZK,WAFY,CAAf","sourcesContent":["import React from \"react\";\nimport { useHandler } from \"@webiny/app/hooks/useHandler\";\nimport { connect } from \"@webiny/app-page-builder/editor/redux\";\nimport { getPlugins } from \"@webiny/plugins\";\nimport { set } from \"dot-prop-immutable\";\nimport { redux } from \"@webiny/app-page-builder/editor/redux\";\nimport { updateElement } from \"@webiny/app-page-builder/editor/actions\";\nimport { getActiveElement } from \"@webiny/app-page-builder/editor/selectors\";\nimport { cloneElement } from \"@webiny/app-page-builder/editor/utils\";\nimport {\n    getElementWithChildren,\n    getParentElementWithChildren\n} from \"@webiny/app-page-builder/editor/selectors\";\nimport { PbEditorPageElementPlugin } from \"@webiny/app-page-builder/types\";\n\nconst CloneAction = props => {\n    const { element, children } = props;\n\n    const onClick = useHandler(props, ({ element, updateElement }) => () => {\n        const state = redux.store.getState();\n        element = getElementWithChildren(state, element.id);\n        const parent = getParentElementWithChildren(state, element.id);\n        const position = parent.elements.findIndex(el => el.id === element.id) + 1;\n\n        const newElement = set(parent, \"elements\", [\n            ...parent.elements.slice(0, position),\n            cloneElement(element),\n            ...(position < parent.elements.length ? parent.elements.slice(position) : [])\n        ]);\n        updateElement({ element: newElement });\n    });\n\n    const plugin = getPlugins<PbEditorPageElementPlugin>(\"pb-editor-page-element\").find(\n        pl => pl.elementType === element.type\n    );\n\n    if (!plugin) {\n        return null;\n    }\n\n    return React.cloneElement(children, { onClick });\n};\n\nexport default connect<any, any, any>(state => ({ element: getActiveElement(state) }), {\n    updateElement\n})(CloneAction);\n"],"file":"CloneAction.js"}