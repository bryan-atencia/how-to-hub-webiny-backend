{"version":3,"sources":["../../../../src/editor/components/Slate/Slate.tsx"],"names":["React","ReactDOM","shortid","Editor","Value","getPlugins","usePageBuilder","createValue","Menu","valueToJSON","value","selection","toJSON","anchorText","getText","focusText","inlines","marks","activeMarks","blocks","texts","SlateEditor","props","createRef","e","nextElement","target","change","callback","state","readOnly","operations","setState","modified","activePlugin","onChange","id","menuContainer","document","getElementById","createElement","setAttribute","body","appendChild","rect","getSelectionRect","top","style","position","pointerEvents","zIndex","left","width","height","native","window","getSelection","type","range","getRangeAt","getBoundingClientRect","container","getMenuContainer","createPortal","exclude","editor","activatePlugin","deactivatePlugin","plugin","generate","showMenu","fromJSON","plugins","filter","pl","includes","name","map","slate","addEventListener","trackNextElement","untrackNextElement","removeEventListener","renderFloatingMenu","theme","ref","onBlur","autoCorrect","spellCheck","placeholder","renderDialog","current","open","closeDialog","cloneElement","key","Component","WithPageBuilderTheme","children"],"mappings":"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","sourcesContent":["import React, { RefObject } from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { get, isEqual, noop } from \"lodash\";\nimport shortid from \"shortid\";\nimport { Editor } from \"slate-react\";\nimport { Value } from \"slate\";\nimport { getPlugins } from \"@webiny/plugins\";\nimport { usePageBuilder } from \"@webiny/app-page-builder/hooks/usePageBuilder\";\nimport { createValue } from \"./index\";\n\nimport Menu from \"./Menu\";\nimport {\n    PbEditorSlateEditorPlugin,\n    PbEditorSlateMenuItemPlugin\n} from \"@webiny/app-page-builder/types\";\n\nconst valueToJSON = value => {\n    return {\n        selection: value.selection.toJSON(),\n        anchorText: value.anchorText.getText(),\n        focusText: value.focusText.getText(),\n        inlines: value.inlines.toJSON(),\n        marks: value.marks.toJSON(),\n        activeMarks: value.activeMarks.toJSON(),\n        blocks: value.blocks.toJSON(),\n        texts: value.texts.toJSON()\n    };\n};\n\nexport type SlateEditorProps = {\n    // Plugin names to exclude\n    exclude?: string[];\n\n    onChange?: (value: { [key: string]: any }) => void;\n};\n\nexport type SlateEditorState = {\n    modified: boolean;\n    showMenu: boolean;\n    value: Value;\n    readOnly: boolean;\n    activePlugin: {\n        plugin: string;\n        value: { [key: string]: any };\n    };\n};\n\nclass SlateEditor extends React.Component<SlateEditorProps, SlateEditorState> {\n    static defaultProps = {\n        exclude: []\n    };\n\n    id: string;\n    nextElement: HTMLElement;\n    plugins = [];\n    editor: RefObject<Editor> = React.createRef();\n\n    constructor(props) {\n        super(props);\n\n        this.id = shortid.generate();\n        this.nextElement = null;\n\n        const value = typeof props.value === \"string\" ? createValue(props.value) : props.value;\n\n        this.state = {\n            modified: false,\n            showMenu: false,\n            value: Value.fromJSON(value),\n            readOnly: !props.onChange,\n            activePlugin: null\n        };\n\n        const plugins = getPlugins<PbEditorSlateEditorPlugin>(\"pb-editor-slate-editor\");\n        this.plugins = plugins.filter(pl => !props.exclude.includes(pl.name)).map(pl => pl.slate);\n    }\n\n    componentDidMount() {\n        document.getElementById(this.id).addEventListener(\"mousedown\", this.trackNextElement);\n        document.getElementById(this.id).addEventListener(\"mouseup\", this.untrackNextElement);\n    }\n\n    componentWillUnmount() {\n        document.getElementById(this.id).removeEventListener(\"mousedown\", this.trackNextElement);\n        document.getElementById(this.id).removeEventListener(\"mouseup\", this.untrackNextElement);\n    }\n\n    trackNextElement = e => {\n        // Store the clicked element. If it is set, it means we clicked inside the editor div.\n        this.nextElement = e.target;\n    };\n\n    untrackNextElement = () => {\n        this.nextElement = null;\n    };\n\n    static getDerivedStateFromProps(props, state) {\n        if (!state.modified && !props.readOnly) {\n            // Got new editor value through props.\n            const value = typeof props.value === \"string\" ? createValue(props.value) : props.value;\n            if (isEqual(value, state.value.toJSON())) {\n                return null;\n            }\n\n            return {\n                value: Value.fromJSON(value)\n            };\n        }\n\n        return null;\n    }\n\n    onChange = (change, callback = noop) => {\n        if (this.state.readOnly) {\n            return;\n        }\n\n        // Prevent `onChange` if it is a `set_value` operation.\n        // We only need to handle changes on user input.\n        const operations = change.operations.toJSON();\n        if (get(operations, \"0.type\") === \"set_value\") {\n            return;\n        }\n\n        // Only update local state.\n        this.setState(\n            state => ({\n                ...state,\n                value: change.value,\n                modified: true\n            }),\n            callback\n        );\n    };\n\n    onBlur = () => {\n        // Do not save changes if there is a plugin that's still active. This can happen, for example, when\n        // you click on the \"Link\" tool, which opens a dialog, which then triggers the blur event and this callback.\n        if (this.state.activePlugin) {\n            return;\n        }\n\n        if (!this.nextElement) {\n            this.setState({ modified: false });\n            this.props.onChange(this.state.value.toJSON());\n        }\n    };\n\n    getMenuContainer = () => {\n        const id = \"slate-menu-container\";\n\n        // Get menu container\n        let menuContainer = document.getElementById(id);\n        if (!menuContainer) {\n            menuContainer = document.createElement(\"div\");\n            menuContainer.setAttribute(\"id\", id);\n            document.body && document.body.appendChild(menuContainer);\n        }\n\n        // Position menu container\n        const rect = this.getSelectionRect();\n        if (rect.top === 0) {\n            return menuContainer;\n        }\n        menuContainer.style.position = \"fixed\";\n        menuContainer.style.pointerEvents = \"none\";\n        menuContainer.style.zIndex = \"4\";\n        menuContainer.style.top = rect.top - 20 + \"px\";\n        menuContainer.style.left = rect.left + \"px\";\n        menuContainer.style.width = rect.width + \"px\";\n        menuContainer.style.height = rect.height + \"px\";\n\n        return menuContainer;\n    };\n\n    getSelectionRect = () => {\n        const native = window.getSelection();\n        if (native.type === \"None\") {\n            return { top: 0, left: 0, width: 0, height: 0 };\n        }\n\n        const range = native.getRangeAt(0);\n        return range.getBoundingClientRect();\n    };\n\n    renderFloatingMenu = () => {\n        const container = this.getMenuContainer();\n\n        if (container) {\n            return ReactDOM.createPortal(\n                <Menu\n                    exclude={this.props.exclude}\n                    value={this.state.value}\n                    onChange={this.onChange}\n                    editor={this.editor}\n                    activatePlugin={this.activatePlugin}\n                    activePlugin={this.state.activePlugin}\n                    deactivatePlugin={this.deactivatePlugin}\n                />,\n                container\n            );\n        }\n\n        return null;\n    };\n\n    activatePlugin = (plugin: string) => {\n        const { value } = this.state;\n\n        this.setState({\n            activePlugin: {\n                plugin,\n                value: valueToJSON(value)\n            }\n        });\n    };\n\n    deactivatePlugin = () => {\n        this.setState({ activePlugin: null });\n    };\n\n    render() {\n        const { activePlugin } = this.state;\n\n        return (\n            <div id={this.id}>\n                {!this.state.readOnly && this.renderFloatingMenu()}\n                <WithPageBuilderTheme>\n                    {({ theme }) =>\n                        React.createElement<any>(Editor, {\n                            ref: this.editor,\n                            onBlur: this.onBlur,\n                            readOnly: this.state.readOnly,\n                            autoCorrect: false,\n                            spellCheck: false,\n                            plugins: this.plugins,\n                            placeholder: \"Enter some text...\",\n                            value: this.state.value,\n                            onChange: this.onChange,\n                            theme: theme,\n                            activatePlugin: name => this.activatePlugin(name),\n                            activePlugin: this.state.activePlugin,\n                            deactivatePlugin: this.deactivatePlugin\n                        })\n                    }\n                </WithPageBuilderTheme>\n                {getPlugins<PbEditorSlateMenuItemPlugin>(\"pb-editor-slate-menu-item\")\n                    .filter(pl => typeof pl.renderDialog === \"function\")\n                    .map(pl => {\n                        const props = {\n                            onChange: change => {\n                                // For dialogs, we send a complete callback, which will not only update the state of\n                                // the Slate editor, but will also save the changes via GraphQL mutation.\n                                this.onChange(change, () =>\n                                    this.props.onChange(this.state.value.toJSON())\n                                );\n                                this.setState({ modified: false });\n                            },\n                            editor: this.editor.current,\n                            open: activePlugin ? activePlugin.plugin === pl.name : false,\n                            closeDialog: this.deactivatePlugin,\n                            activePlugin,\n                            activatePlugin: name => this.activatePlugin(name)\n                        };\n                        return React.cloneElement(pl.renderDialog(props), { key: pl.name });\n                    })}\n            </div>\n        );\n    }\n}\n\nconst WithPageBuilderTheme = ({ children }) => {\n    const { theme } = usePageBuilder();\n    return children({ theme });\n};\n\nexport default SlateEditor;\n"],"file":"Slate.js"}