{"version":3,"sources":["../../../src/editor/components/Droppable.ts"],"names":["React","useDrop","connect","getIsDragging","defaultVisibility","type","isDragging","item","target","includes","Droppable","memo","props","children","isDroppable","onDrop","isVisible","accept","collect","monitor","isOver","shallow","getItem","drop","mapStateToProps","state"],"mappings":";AAAA,OAAO,KAAKA,KAAZ,MAAuB,OAAvB;AACA,SAAgDC,OAAhD,QAA+D,WAA/D;AACA,SAASC,OAAT,QAAwB,uCAAxB;AACA,SAASC,aAAT,QAA8B,2CAA9B;;AAEA,IAAMC,iBAAiB,GAAG,SAApBA,iBAAoB,OAAgC;AAAA,MAA7BC,IAA6B,QAA7BA,IAA6B;AAAA,MAAvBC,UAAuB,QAAvBA,UAAuB;AAAA,MAAXC,IAAW,QAAXA,IAAW;AACtD,MAAMC,MAAM,GAAID,IAAI,IAAIA,IAAI,CAACC,MAAd,IAAyB,EAAxC;;AAEA,MAAI,CAACD,IAAD,IAAS,CAACC,MAAM,CAACC,QAAP,CAAgBJ,IAAhB,CAAd,EAAqC;AACjC,WAAO,KAAP;AACH;;AAED,SAAOC,UAAP;AACH,CARD;;AA0BA,IAAMI,SAAS,gBAAGV,KAAK,CAACW,IAAN,CAAW,UAACC,KAAD,EAA2B;AAAA,MAC5CP,IAD4C,GACqBO,KADrB,CAC5CP,IAD4C;AAAA,MACtCQ,QADsC,GACqBD,KADrB,CACtCC,QADsC;AAAA,MAC5BP,UAD4B,GACqBM,KADrB,CAC5BN,UAD4B;AAAA,2BACqBM,KADrB,CAChBE,WADgB;AAAA,MAChBA,WADgB,mCACF;AAAA,WAAM,IAAN;AAAA,GADE;AAAA,MACUC,MADV,GACqBH,KADrB,CACUG,MADV;AAAA,MAE9CC,SAF8C,GAEhCJ,KAFgC,CAE9CI,SAF8C;;AAAA,iBAInBf,OAAO,CAAC;AACrCgB,IAAAA,MAAM,EAAE,SAD6B;AAErCC,IAAAA,OAAO,EAAE,iBAAAC,OAAO;AAAA,aAAK;AACjBC,QAAAA,MAAM,EAAED,OAAO,CAACC,MAAR,MAAoBD,OAAO,CAACC,MAAR,CAAe;AAAEC,UAAAA,OAAO,EAAE;AAAX,SAAf,CADX;AAEjBd,QAAAA,IAAI,EAAEY,OAAO,CAACG,OAAR;AAFW,OAAL;AAAA,KAFqB;AAMrCC,IAAAA,IANqC,gBAMhChB,IANgC,EAM1BY,OAN0B,EAMjB;AAChB,UAAI,OAAOJ,MAAP,KAAkB,UAAtB,EAAkC;AAC9BA,QAAAA,MAAM,CAACI,OAAO,CAACG,OAAR,EAAD,CAAN;AACH;AACJ;AAVoC,GAAD,CAJY;AAAA;AAAA;AAAA,MAI3Cf,IAJ2C,cAI3CA,IAJ2C;AAAA,MAIrCa,MAJqC,cAIrCA,MAJqC;AAAA,MAI3BG,IAJ2B;;AAiBpD,MAAI,CAACP,SAAL,EAAgB;AACZA,IAAAA,SAAS,GAAGZ,iBAAZ;AACH;;AAED,MAAI,CAACY,SAAS,CAAC;AAAEX,IAAAA,IAAI,EAAJA,IAAF;AAAQE,IAAAA,IAAI,EAAJA,IAAR;AAAcD,IAAAA,UAAU,EAAVA;AAAd,GAAD,CAAd,EAA4C;AACxC,WAAO,IAAP;AACH;;AAED,SAAOO,QAAQ,CAAC;AAAEP,IAAAA,UAAU,EAAVA,UAAF;AAAcc,IAAAA,MAAM,EAANA,MAAd;AAAsBN,IAAAA,WAAW,EAAEA,WAAW,CAACP,IAAD,CAA9C;AAAsDgB,IAAAA,IAAI,EAAJA;AAAtD,GAAD,CAAf;AACH,CA1BiB,CAAlB;;AA4BA,IAAMC,eAAe,GAAG,SAAlBA,eAAkB,CAAAC,KAAK;AAAA,SAAK;AAAEnB,IAAAA,UAAU,EAAEH,aAAa,CAACsB,KAAD;AAA3B,GAAL;AAAA,CAA7B;;AAEA,eAAevB,OAAO,CAAgBsB,eAAhB,CAAP,CAAwCd,SAAxC,CAAf","sourcesContent":["import * as React from \"react\";\nimport { ConnectDropTarget, DragObjectWithType, useDrop } from \"react-dnd\";\nimport { connect } from \"@webiny/app-page-builder/editor/redux\";\nimport { getIsDragging } from \"@webiny/app-page-builder/editor/selectors\";\n\nconst defaultVisibility = ({ type, isDragging, item }) => {\n    const target = (item && item.target) || [];\n\n    if (!item || !target.includes(type)) {\n        return false;\n    }\n\n    return isDragging;\n};\n\nexport type DroppableChildrenFunction = (params: {\n    isDragging: boolean;\n    isOver: boolean;\n    isDroppable: boolean;\n    drop: ConnectDropTarget;\n}) => React.ReactElement;\n\nexport type DroppableProps = {\n    type: string;\n    children: DroppableChildrenFunction;\n    isDragging: boolean;\n    isDroppable(item: any): boolean;\n    isVisible(params: { type: string; item: any; isDragging: boolean }): boolean;\n    onDrop(item: DragObjectWithType);\n};\n\nconst Droppable = React.memo((props: DroppableProps) => {\n    const { type, children, isDragging, isDroppable = () => true, onDrop } = props;\n    let { isVisible } = props;\n\n    const [{ item, isOver }, drop] = useDrop({\n        accept: \"element\",\n        collect: monitor => ({\n            isOver: monitor.isOver() && monitor.isOver({ shallow: true }),\n            item: monitor.getItem()\n        }),\n        drop(item, monitor) {\n            if (typeof onDrop === \"function\") {\n                onDrop(monitor.getItem());\n            }\n        }\n    });\n\n    if (!isVisible) {\n        isVisible = defaultVisibility;\n    }\n\n    if (!isVisible({ type, item, isDragging })) {\n        return null;\n    }\n\n    return children({ isDragging, isOver, isDroppable: isDroppable(item), drop });\n});\n\nconst mapStateToProps = state => ({ isDragging: getIsDragging(state) });\n\nexport default connect<any, any, any>(mapStateToProps)(Droppable);\n"],"file":"Droppable.js"}