{"version":3,"sources":["../../../src/editor/selectors/index.ts"],"names":["invariant","getPlugin","getPluginType","name","plugin","type","getUi","state","ui","getPage","page","getRevisions","revisions","getContent","content","present","document","create","getElementWithChildren","id","element","getElement","path","replace","slice","elements","hasOwnProperty","Object","values","find","el","getParentElementWithChildren","parentPaths","split","length","join","getActiveElement","getActiveElementId","activeElement","getPlugins","plugins","getPluginsByType","getActivePlugins","pluginsByType","getActivePluginParams","pl","params","isPluginActive","Boolean","getIsDragging","dragging","getElementProps","highlightElement","resizing","active","highlight"],"mappings":"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","sourcesContent":["import _ from \"lodash\";\nimport invariant from \"invariant\";\nimport { getPlugin } from \"@webiny/plugins\";\nimport {\n    State,\n    PbElement,\n    PbDocumentElementPlugin,\n    PbShallowElement\n} from \"@webiny/app-page-builder/types\";\n\nconst getPluginType = (name: string) => {\n    const plugin = getPlugin(name);\n    return plugin ? plugin.type : null;\n};\n\n/**\n * Get editor `ui` state\n */\nexport const getUi = (state: State): any => state.ui || {};\n\n/**\n * Get editor `page` state\n */\nexport const getPage = (state: State): any => state.page || {};\n\n/**\n * Get editor `revisions` state\n */\nexport const getRevisions = (state: State): Array<any> => state.revisions || [];\n\n/**\n * Get editor content.\n */\nexport const getContent = (state: State): any => {\n    const page = getPage(state);\n    if (page.content && page.content.present) {\n        return page.content.present;\n    } else if (page.content) {\n        return page.content;\n    }\n\n    const document = getPlugin<PbDocumentElementPlugin>(\"pb-editor-page-element-document\");\n    invariant(\n        document,\n        `\"pb-editor-page-element-document\" plugin must exist for Page Builder to work!`\n    );\n    return document.create();\n};\n\n/**\n * Get element and all of its children recursively.\n * WARNING: use carefully as this makes render optimization really difficult when used in `connect`!\n */\nexport const getElementWithChildren = (state: State, id: string): PbElement | null => {\n    const element = getElement(state, id);\n    if (!element) {\n        return null;\n    }\n\n    const content = getContent(state);\n    return _.get(content, element.path.replace(/\\./g, \".elements.\").slice(2));\n};\n\n/**\n * Get element by ID or path.\n * @param state\n * @param id ID or path of the element\n */\nexport const getElement = (state: State, id: string): PbShallowElement => {\n    if (state.elements.hasOwnProperty(id)) {\n        return state.elements[id];\n    }\n\n    // Find by path\n    return Object.values(state.elements).find(el => el.path === id);\n};\n\n/**\n * Get parent element and all of its children recursively\n * WARNING: use carefully as this makes render optimization really difficult when used in `connect`!\n * @param state\n * @param id\n * @returns {*}\n */\nexport const getParentElementWithChildren = (state: State, id: string): PbElement => {\n    const element = getElement(state, id);\n    const content = getContent(state);\n    const parentPaths = element.path.split(\".\").slice(0, -1);\n    if (parentPaths.length === 1) {\n        return content;\n    }\n\n    return _.get(content, parentPaths.join(\".elements.\").slice(2));\n};\n\nexport const getActiveElement = (state: State) => getElement(state, getActiveElementId(state));\n\n/**\n * Get active element ID.\n */\nexport const getActiveElementId = (state: State): string => getUi(state).activeElement;\n\n/**\n * Get editor plugins (this mostly contains UI state).\n */\nexport const getPlugins = (state: State): Object => getUi(state).plugins || {};\n\n/**\n * Get editor plugins of certain type (this mostly contains UI state).\n */\nexport const getPluginsByType = (type: string) => {\n    return (state: State) => getPlugins(state)[type] || [];\n};\n\n/**\n * Get an active plugin of the given type.\n */\nexport const getActivePlugins = (type: string) => {\n    const pluginsByType = getPluginsByType(type);\n    return (state: State) => {\n        return pluginsByType(state) || [];\n    };\n};\n\n/**\n * Get active plugin params\n */\nexport const getActivePluginParams = (name: string) => {\n    const type = getPluginType(name);\n    if (typeof type !== \"string\") {\n        return null;\n    }\n    const pluginsByType = getPluginsByType(type);\n    return (state: State) => {\n        const plugins = pluginsByType(state);\n        if (plugins) {\n            const plugin = plugins.find(pl => pl.name === name);\n            return plugin ? plugin.params : null;\n        }\n        return null;\n    };\n};\n\nexport const isPluginActive = (name: string) => {\n    const type = getPluginType(name);\n    if (typeof type !== \"string\") {\n        // eslint-disable-next-line\n        return (state: State) => false;\n    }\n\n    const pluginsByType = getPluginsByType(type);\n\n    return (state: State) => {\n        return Boolean(pluginsByType(state).find(pl => pl.name === name));\n    };\n};\n\n/**\n * Get dragging state.\n */\nexport const getIsDragging = (state: State) => getUi(state).dragging;\n\n/**\n * Get props that need to be passed to an <Element>.\n */\nexport const getElementProps = (state: State, { id }) => {\n    const { activeElement, highlightElement, resizing, dragging } = getUi(state);\n    const element = state.elements[id];\n\n    const active = activeElement && activeElement === element.id;\n    const highlight = active || (highlightElement && highlightElement === id);\n\n    return {\n        active,\n        highlight: highlight && !dragging && !resizing\n    };\n};\n"],"file":"index.js"}