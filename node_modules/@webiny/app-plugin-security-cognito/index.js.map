{"version":3,"sources":["../src/index.tsx"],"names":["React","Auth","Authentication","factory","config","configure","name","type","securityProviderHook","onIdToken","renderAuthentication","viewProps","logout","signOut","getIdToken","currentSession","cognitoUser","idToken","getJwtToken"],"mappings":";;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,IAAP,MAAiB,mBAAjB;AACA,OAAOC,cAAP,MAA2B,kBAA3B;;AAGA,IAAMC,OAAO,GAAG,SAAVA,OAAU,CAACC,MAAD,EAAkD;AAC9D;AACAH,EAAAA,IAAI,CAACI,SAAL,CAAeD,MAAf;AAEA,SAAO;AACHE,IAAAA,IAAI,EAAE,0CADH;AAEHC,IAAAA,IAAI,EAAE,kCAFH;AAGHC,IAAAA,oBAHG,sCAGiC;AAAA,UAAbC,SAAa,QAAbA,SAAa;;AAChC,UAAMC,oBAAoB,GAAG,SAAvBA,oBAAuB,GAA6B;AAAA,wFAAP,EAAO;AAAA,oCAA1BC,SAA0B;AAAA,YAA1BA,SAA0B,gCAAd,EAAc;;AACtD,4BAAO,oBAAC,cAAD;AAAgB,UAAA,SAAS,EAAEF;AAA3B,WAA0CE,SAA1C,EAAP;AACH,OAFD;;AAIA,UAAMC,MAAM;AAAA,6EAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yBACLX,IAAI,CAACY,OAAL,EADK;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAH;;AAAA,wBAAND,MAAM;AAAA;AAAA;AAAA,SAAZ;;AAIA,UAAME,UAAU;AAAA,6EAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yBACWb,IAAI,CAACc,cAAL,EADX;;AAAA;AACTC,kBAAAA,WADS;AAETC,kBAAAA,OAFS,GAECD,WAAW,CAACF,UAAZ,EAFD;AAAA,oDAGRE,WAAW,GAAGC,OAAO,CAACC,WAAR,EAAH,GAA2B,IAH9B;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAH;;AAAA,wBAAVJ,UAAU;AAAA;AAAA;AAAA,SAAhB;;AAMA,aAAO;AAAEA,QAAAA,UAAU,EAAVA,UAAF;AAAcJ,QAAAA,oBAAoB,EAApBA,oBAAd;AAAoCE,QAAAA,MAAM,EAANA;AAApC,OAAP;AACH;AAnBE,GAAP;AAqBH,CAzBD;;AA2BA,eAAeT,OAAf","sourcesContent":["import React from \"react\";\nimport Auth from \"@aws-amplify/auth\";\nimport Authentication from \"./Authentication\";\nimport { SecurityAuthenticationProviderPlugin } from \"@webiny/app-security/types\";\n\nconst factory = (config): SecurityAuthenticationProviderPlugin => {\n    // Configure Amplify Auth\n    Auth.configure(config);\n\n    return {\n        name: \"security-authentication-provider-cognito\",\n        type: \"security-authentication-provider\",\n        securityProviderHook({ onIdToken }) {\n            const renderAuthentication = ({ viewProps = {} } = {}) => {\n                return <Authentication onIdToken={onIdToken} {...viewProps} />;\n            };\n\n            const logout = async () => {\n                await Auth.signOut();\n            };\n\n            const getIdToken = async () => {\n                const cognitoUser = await Auth.currentSession();\n                const idToken = cognitoUser.getIdToken();\n                return cognitoUser ? idToken.getJwtToken() : null;\n            };\n\n            return { getIdToken, renderAuthentication, logout };\n        }\n    };\n};\n\nexport default factory;"],"file":"index.js"}