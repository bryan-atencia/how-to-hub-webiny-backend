import _regeneratorRuntime from "@babel/runtime/regenerator";
import _asyncToGenerator from "@babel/runtime/helpers/asyncToGenerator";
import _objectSpread from "@babel/runtime/helpers/objectSpread2";
import load from "load-src";

var prepareParams = function prepareParams(params) {
  var prepared = _objectSpread({
    content: {}
  }, params);

  if (!prepared.content.href) {
    prepared.showLink = false;
  }

  if (!prepared.content.dismiss) {
    delete prepared.content.dismiss;
  }

  if (!prepared.content.message) {
    delete prepared.content.message;
  }

  return prepared;
};

var initialized = false;

var showCookiePolicy = /*#__PURE__*/function () {
  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(params) {
    var previewMode,
        _args = arguments;
    return _regeneratorRuntime.wrap(function _callee$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            previewMode = _args.length > 1 && _args[1] !== undefined ? _args[1] : false;

            if (previewMode) {
              _context.next = 5;
              break;
            }

            if (!initialized) {
              _context.next = 4;
              break;
            }

            return _context.abrupt("return");

          case 4:
            initialized = true;

          case 5:
            _context.next = 7;
            return load("//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.css", "//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.0/cookieconsent.min.js");

          case 7:
            // @ts-ignore
            window.cookieconsent.initialise(prepareParams(params));

          case 8:
          case "end":
            return _context.stop();
        }
      }
    }, _callee);
  }));

  return function showCookiePolicy(_x) {
    return _ref.apply(this, arguments);
  };
}();

export default showCookiePolicy;
//# sourceMappingURL=showCookiePolicy.js.map