{"version":3,"sources":["../src/index.js"],"names":["state","listenerAttached","zIndex","handlers","triggerHotkeys","e","keys","key","registerZIndex","Object","length","Error","document","body","addEventListener","unregisterZIndex","window","Math","max","removeEventListener","useEffect","React","useRef","useHotkeys","props","disabled","refs","prevProps","firstRender","current","assign","Hotkeys","children"],"mappings":"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","sourcesContent":["// @flow\nimport * as React from \"react\";\nimport isHotkey from \"is-hotkey\";\n\ntype HookProps = {\n    disabled?: boolean,\n    zIndex: number,\n    keys?: { [string]: Function }\n};\n\ntype HocProps = {\n    children: ?React.Node,\n    disabled?: boolean,\n    zIndex: number,\n    keys: { [string]: Function }\n};\n\ntype State = {\n    listenerAttached: boolean,\n    zIndex: null | number,\n    handlers: Object\n};\n\nconst state: State = {\n    listenerAttached: false,\n    zIndex: null,\n    handlers: {}\n};\n\nfunction triggerHotkeys(e: Event) {\n    if (state.zIndex === null) {\n        return;\n    }\n\n    const keys = state.handlers[state.zIndex];\n    for (let key in keys) {\n        if (isHotkey(key, e)) {\n            keys[key](e);\n            break;\n        }\n    }\n}\n\nfunction registerZIndex({ zIndex, keys }) {\n    if (state.zIndex === null || state.zIndex < zIndex) {\n        state.zIndex = zIndex;\n    }\n\n    if (!state.handlers[zIndex]) {\n        state.handlers[zIndex] = {};\n    }\n\n    if (!keys || Object.keys(keys).length === 0) {\n        return;\n    }\n\n    for (let key in keys) {\n        if (key in state.handlers[zIndex]) {\n            throw Error(`Shortcut \"${key}\" already registered on zIndex ${zIndex}.`);\n        }\n        state.handlers[zIndex][key] = keys[key];\n    }\n\n    if (!state.listenerAttached) {\n        // $FlowFixMe\n        document.body.addEventListener(\"keydown\", triggerHotkeys);\n        state.listenerAttached = true;\n    }\n}\n\nfunction unregisterZIndex({ zIndex, keys }) {\n    if (state.handlers && state.handlers[zIndex]) {\n        for (let key in keys) {\n            delete state.handlers[zIndex][key];\n        }\n\n        if (Object.keys(state.handlers[zIndex]).length === 0) {\n            delete state.handlers[zIndex];\n        }\n    }\n\n    if (Object.keys(state.handlers).length > 0) {\n        // Fall back to the highest registered z-index.\n        state.zIndex = window.Math.max(...Object.keys(state.handlers));\n    } else {\n        state.zIndex = null;\n\n        if (state.listenerAttached) {\n            // $FlowFixMe\n            document.body.removeEventListener(\"keydown\", triggerHotkeys);\n            state.listenerAttached = false;\n        }\n    }\n}\n\nconst { useEffect, useRef } = React;\n\nexport function useHotkeys(props: HookProps) {\n    const { disabled, zIndex, keys } = props;\n\n    const refs = {\n        prevProps: useRef(),\n        firstRender: useRef(true)\n    };\n\n    useEffect(function() {\n        if (refs.firstRender.current || refs.prevProps.current.disabled !== disabled) {\n            refs.firstRender.current = false;\n            disabled ? unregisterZIndex(props) : registerZIndex(props);\n        }\n\n        if (!disabled && typeof keys === \"object\") {\n            Object.assign(state.handlers[zIndex], keys);\n        }\n        refs.prevProps.current = { ...props };\n    });\n\n    useEffect(function() {\n        return function() {\n            !disabled && unregisterZIndex(props);\n        };\n    }, []);\n}\n\nexport function Hotkeys({ children, ...props }: HocProps) {\n    useHotkeys(props);\n    return <>{children}</>;\n}\n"],"file":"index.js"}